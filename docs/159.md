# ä»‹ç»

> åŸæ–‡ï¼š<https://github.com/figment-networks/learn-tutorials/blob/master/solana/sol-blog-dapp.md>

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•åˆ›å»ºä¸€ä¸ªç®€å•çš„å…³äºç´¢æ‹‰çº³åŒºå—é“¾çš„åšå®¢æ–‡ç«  dappã€‚åœ¨æ„å»ºè¿™ä¸ª dapp æ—¶ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ç¼–å†™ Solana rust ç¨‹åºï¼Œæµ‹è¯•è¯¥ç¨‹åºï¼Œå¹¶æœ€ç»ˆå°†è¯¥ç¨‹åºä¸ React å‰ç«¯é›†æˆã€‚

**æœ€ç»ˆ Dapp**

![](img/467ed461cfbf3e35359c1e41921a11bb.png)

# å…ˆå†³æ¡ä»¶

æœ¬æ•™ç¨‹å‡è®¾æ‚¨å·²ç»ï¼Œ

*   å¯¹ React.js çš„åŸºæœ¬äº†è§£
*   å¯¹é“é”ˆçš„åŸºæœ¬è®¤è¯†
*   å®Œæˆ[èŒ„ 101 é€”å¾„](https://learn.figment.io/protocols/Solana)

# è¦æ±‚

æœ¬æ•™ç¨‹ä»‹ç»äº†å¦‚ä½•åœ¨ Solana ä¸Šæ„å»º dappï¼Œä½†æ²¡æœ‰ä»‹ç»å„ä¸ªä¾èµ–é¡¹çš„å®‰è£…(å› ä¸ºå®ƒå‡è®¾æ‚¨å·²ç»å®Œæˆäº† Figment learn ä¸Šçš„ Solana 101 é€”å¾„)ã€‚

*   **Anchor æ¡†æ¶-** Anchor æ˜¯ä¸€ä¸ªç”¨äº Solana dapp å¼€å‘çš„æ¡†æ¶ï¼Œå®ƒæä¾› DSL æ¥ä¸ Solana ç¨‹åºäº¤äº’ã€‚å¦‚æœä½ ç†Ÿæ‚‰å‘å±•ä¸­çš„åšå®ï¼Œæ¾éœ²æˆ–å®‰å…¨å¸½ï¼Œç„¶åè€ƒè™‘ DSL ç›¸å½“äº ABIã€‚æŒ‰ç…§æŒ‡å—å®‰è£…[é”š](https://project-serum.github.io/anchor/getting-started/installation.html#install-rust)è¿åŒé“é”ˆå’ŒèŒ„ç¢±ã€‚

*   **React.js -** ä¸ºäº†ä¸æˆ‘ä»¬çš„ Solana ç¨‹åºè¿›è¡Œäº¤äº’ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ React.js åˆ›å»ºå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºã€‚

*   å¹»å½±é’±åŒ…- å¹»å½±æ˜¯ä¸€ä¸ªæ•°å­—é’±åŒ…ï¼Œå¯ä»¥è®©ä½ å°†ä½ çš„åŠ å¯†è´¦æˆ·è¿æ¥åˆ°ä»»ä½•ä¸€ä¸ªå»ºç«‹åœ¨ç´¢æ‹‰çº³åŒºå—é“¾ä¸Šçš„ dappã€‚æˆ‘ä»¬å°†ä½¿ç”¨å¹»å½±é’±åŒ…è¿æ¥åˆ°æˆ‘ä»¬çš„åšå®¢ Dappã€‚

*   æˆ‘å°†æ¨èä½¿ç”¨ Vs code å’Œ rust analyzer æ‰©å±•ï¼Œå› ä¸ºå®ƒå¯¹ rust è¯­è¨€æœ‰å¾ˆå¥½çš„æ”¯æŒã€‚

# ç´¢æ‹‰çº³è§„åˆ’æ¨¡å‹

**Program -** Solana æ˜¯ä¸€æ¬¾å¿«é€Ÿä¸”ä½æˆæœ¬çš„åŒºå—é“¾ï¼Œå®ç°é€Ÿåº¦å’Œä½æˆæœ¬çš„ Solana ç¼–ç¨‹æ¨¡å¼ç•¥æœ‰ä¸åŒã€‚Solana ä½¿ç”¨ Rust ç¼–ç¨‹è¯­è¨€åˆ›å»ºç¨‹åºï¼Œå› ä¸ºï¼Œä½ æ³¨æ„åˆ°æˆ‘ä»¬ä¸€ç›´åœ¨è¯´ Solana ç¨‹åºï¼Œè€Œä¸æ˜¯ Solana æ™ºèƒ½åˆåŒï¼Œä»é€‰æ‹©ç¼–ç¨‹è¯­è¨€åˆ°å‘½åæ¦‚å¿µï¼ŒSolana æ˜¯ä¸åŒçš„ï¼Œåœ¨ Solana world ä¸­ï¼Œæ™ºèƒ½åˆåŒè¢«ç§°ä¸º Solana ç¨‹åºã€‚

Solana ç¨‹åºæ˜¯æ— çŠ¶æ€çš„ï¼Œæ‰€ä»¥å¦‚æœä½ æƒ³å­˜å‚¨çŠ¶æ€ï¼Œä½ éœ€è¦ä¸ºå®ƒä½¿ç”¨ä¸€ä¸ªå¸æˆ·ï¼Œå¹¶ä¸”å¸æˆ·çš„å¤§å°æ˜¯å›ºå®šçš„ã€‚ä¸€æ—¦è´¦æˆ·è¢«åˆå§‹åŒ–ä¸ºè¿™ä¸ªå¤§å°ï¼Œä½ å°±ä¸èƒ½åœ¨ä»¥åæ”¹å˜å®ƒçš„å¤§å°ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è®¾è®¡æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ—¶å¿…é¡»è®°ä½è¿™ä¸€ç‚¹ã€‚

**ç§Ÿé‡‘-** åœ¨ Solana ä¸Šï¼Œä½ éœ€è¦å®šæœŸæ”¯ä»˜ç§Ÿé‡‘ï¼Œæ ¹æ®æ•°æ®æ‰€éœ€çš„ç©ºé—´åœ¨åŒºå—é“¾ä¸Šå­˜å‚¨æ•°æ®ï¼Œå¦‚æœå¸æˆ·ä½™é¢é«˜äºæŸä¸ªé˜ˆå€¼(å–å†³äºå…¶å ç”¨çš„ç©ºé—´),åˆ™å¯ä»¥å…é™¤ç§Ÿé‡‘(æ„å‘³ç€ä½ ä¸å¿…æ”¯ä»˜ç§Ÿé‡‘)ã€‚

# åº”ç”¨è®¾è®¡å†³ç­–

æ­£å¦‚æˆ‘ä»¬æ‰€çŸ¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¸æˆ·æ¥åˆ›å»ºæˆ‘ä»¬çš„åšå®¢ dappï¼Œå®ƒæœ‰ä¸€ä¸ªå›ºå®šçš„å¤§å°ï¼Œæ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª X å¤§å°çš„å¸æˆ·ï¼Œå¹¶å¼€å§‹åœ¨è¯¥å¸æˆ·å†…æ¨é€å¸–å­ï¼Œæœ€ç»ˆè¯¥å¸æˆ·å°†è¶…è¿‡å…¶å¤§å°é™åˆ¶ï¼Œæˆ‘ä»¬å°†æ— æ³•åˆ›å»ºæ–°çš„å¸–å­ã€‚å¦‚æœä½ çŸ¥é“ Solidityï¼Œåœ¨ Solidity ä¸­æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŠ¨æ€æ•°ç»„ï¼Œå¹¶å‘å…¶ä¸­æ¨é€æˆ‘ä»¬æƒ³è¦çš„å°½å¯èƒ½å¤šçš„é¡¹ç›®ï¼Œä½†åœ¨ Solana ä¸­ï¼Œæˆ‘ä»¬çš„å¸æˆ·å¤§å°æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»æ‰¾åˆ°è¿™ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚

*   **è§£å†³æ–¹æ¡ˆä¸€-** å¦‚æœæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªéå¸¸å¤§çš„è´¦æˆ·ï¼Œæ¯”å¦‚åƒå…†å­—èŠ‚ï¼Œä¼šæ€ä¹ˆæ ·ï¼Ÿåœ¨ Solana ä¸Šï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®å¸æˆ·å¤§å°æ”¯ä»˜ç§Ÿé‡‘ï¼Œå› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬çš„å¸æˆ·å¤§å°å¢åŠ ï¼Œå¸æˆ·ç§Ÿé‡‘ä¹Ÿä¼šéšä¹‹å¢åŠ ã€‚

*   **è§£å†³æ–¹æ¡ˆäºŒ-** å¦‚æœæˆ‘ä»¬åˆ›å»ºå¤šä¸ªè´¦æˆ·å¹¶ä»¥æŸç§æ–¹å¼å°†å®ƒä»¬è¿æ¥èµ·æ¥ä¼šæ€ä¹ˆæ ·ï¼Ÿæ˜¯çš„ï¼Œè¿™æ˜¯è®¡åˆ’ã€‚æˆ‘ä»¬å°†ä¸ºæ¯ä¸ªå¸–å­åˆ›å»ºä¸€ä¸ªæ–°å¸æˆ·ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ¥ä¸€ä¸ªé“¾æ¥çš„å¸–å­é“¾ã€‚

é“¾æ¥<g-emoji class="g-emoji" alias="thinking" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f914.png">ğŸ¤”</g-emoji>å¯¹ï¼Œä½ çŒœå¯¹äº†ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ LinkedList æ¥è¿æ¥æ‰€æœ‰çš„å¸–å­ã€‚

# å»ºç«‹åœ°æ–¹å‘å±•

åœ¨æˆ‘ä»¬å¼€å§‹å®é™…å¼€å‘ä¹‹å‰ã€‚æˆ‘ä»¬å­¦ä¹ ä¸€äº› Solana CLI å‘½ä»¤[æ–‡æ¡£](https://docs.Solana.com/cli/conventions):

è¦æŸ¥çœ‹æ‚¨å½“å‰çš„ Solana é…ç½®ï¼Œè¯·ä½¿ç”¨(æˆ‘å‡è®¾æ‚¨å·²ç»å­¦ä¹ äº† Solana 101 Pathwayï¼Œå¹¶ä¸”å·²ç»å®Œæˆäº†æ‰€æœ‰ CLI å®‰è£…):

```js
solana config get

Config File: /Users/user/.config/Solana/cli/config.yml
RPC URL: https://api.devnet.Solana.com
WebSocket URL: wss://api.devnet.Solana.com/ (computed)
Keypair Path: /home/user/.config/Solana/id.json
Commitment: confirmed 
```

æ‚¨çš„è¾“å‡ºå¯èƒ½æœ‰ä¸åŒçš„æ–‡ä»¶è·¯å¾„ã€‚æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æŸ¥çœ‹å½“å‰é’±åŒ…åœ°å€:

```js
solana address 
```

æ‚¨å¯ä»¥æŸ¥çœ‹æ‚¨çš„é’±åŒ…ä½™é¢:

```js
solana balance 
```

æˆ–è€…ï¼Œæ‚¨å¯ä»¥å‘æ‚¨çš„å¸æˆ·ç©ºæŠ•ä»£å¸:

```js
solana airdrop 1 <your-account-address> 
```

å†æ¬¡æ£€æŸ¥å¹³è¡¡ã€‚ç°åœ¨ä½ çš„é’±åŒ…é‡Œåº”è¯¥æœ‰ 1 ç´¢å°”çš„ä½™é¢äº†ã€‚

**ç°åœ¨æ˜¯æ—¶å€™åœ¨ Anchor CLI çš„å¸®åŠ©ä¸‹æ­å»ºæˆ‘ä»¬çš„åšå®¢åº”ç”¨äº†:**

```js
anchor init blog
cd blog 
```

anchor init å‘½ä»¤åˆ›å»ºä»¥ä¸‹ç›®å½•:

```js
â”œâ”€â”€ app
â”œâ”€â”€ programs
|   â””â”€â”€ blog
|        â””â”€â”€ src
|             â””â”€â”€ lib.rs
â”œâ”€â”€ test 
```

åœ¨ç¼–å†™ç¨‹åºä»£ç ä¹‹å‰ï¼Œæ›´æ–° Anchor.toml

```js
wallet = "your Keypair Path from the output of solana config get" 
```

# åˆ›å»ºåšå®¢ç¨‹åº

ç°åœ¨æˆ‘ä»¬å‡†å¤‡å¼€å§‹ç´¢æ‹‰çº³é”ˆç—…è®¡åˆ’ã€‚æ‰“å¼€ä½äº`/program/blog/src/`æ–‡ä»¶å¤¹ä¸­çš„`lib.rs`æ–‡ä»¶ã€‚

```js
use anchor_lang::prelude::*;

declare_id!("Fg6PaFpoGXkYsidMpWTK6W2BeZ7FEfcYkg476zPFsLnS");

#[program]
pub mod blog {
    use super::*;
    pub fn initialize(ctx: Context<Initialize>) -> ProgramResult {
        Ok(())
    }
}

#[derive(Accounts)]
pub struct Initialize {}
```

è¿™æ˜¯ä¸€ä¸ªé”šç´¢æ‹‰çº³ç¨‹åºçš„åŸºæœ¬ä¾‹å­ã€‚åªæœ‰ä¸€ä¸ªå‡½æ•°`initialize`ï¼Œå°†ç”±å®¢æˆ·ç«¯è°ƒç”¨ã€‚initialize å‡½æ•°æœ‰ä¸€ä¸ª`Initialize`ç»“æ„çš„ç±»å‹ä¸Šä¸‹æ–‡å‚æ•°ã€‚

å¦ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„æ˜¯`declare_id!`ï¼Œå®ƒæ˜¯ä¸€ä¸ªå®šä¹‰ç¨‹åºåœ°å€çš„å®ï¼Œç”¨äºå†…éƒ¨éªŒè¯ã€‚æˆ‘ä»¬ä¸ç”¨æƒ³å¤ªå¤šã€‚è¿™å°†ç”±é”šç‚¹ CLI å¤„ç†ã€‚

ç°åœ¨æ˜¯æ—¶å€™å¼€å§‹å£°æ˜æˆ‘ä»¬åšå®¢åº”ç”¨çš„çŠ¶æ€äº†ã€‚

```js
// pseudo code

blog {
 current_post_key    // latest post id so we can traverse back to other posts
 authority           // who owns the account
}

user {
 name                // store user name
 avatar              // user avatar
 authority           // owner
}

post {
 title              // post title
 content            // post descriptive content
 user               // user id
 pre_post_key       // to create LinkedList
 authority          // owner
} 
```

æ­£å¦‚æ‚¨åœ¨ç¬¬ä¸€ä¸ªåŸºæœ¬ç¤ºä¾‹ä¸­çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€äº›å‡½æ•°æ¥å®šä¹‰æˆ‘ä»¬å¸Œæœ›åœ¨ç¨‹åºä¸Šæ‰§è¡Œçš„ä»»åŠ¡ï¼Œå¦‚ init_blogã€signup_userã€create_post ç­‰ã€‚

æˆ‘ä»¬å°†ä»åˆ›å»ºæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªå‡½æ•°`init_blog`å¼€å§‹ã€‚

```js
 pub fn init_blog(ctx: Context<InitBlog>) -> ProgramResult {
        Ok(())
 }

 // define ctx type
  #[derive(Accounts)]
  pub struct InitBlog<'info> {
      #[account(init, payer = authority, space = 8 + 32 + 32)]
      pub blog_account: Account<'info, BlogState>,
      #[account(init, payer = authority, space = 8 + 32 + 32 + 32 + 32 + 8)]
      pub genesis_post_account: Account<'info, PostState>,
      pub authority: Signer<'info>,
      pub system_program: Program<'info, System>,
  }

  // from pseudo blog state
  #[account]
  pub struct BlogState {
      pub current_post_key: Pubkey,
      pub authority: Pubkey,
  }
```

ä¼—æ‰€å‘¨çŸ¥ï¼Œæ¯ä¸ªå‡½æ•°éƒ½éœ€è¦ä¸€ä¸ªç±»å‹åŒ–çš„ä¸Šä¸‹æ–‡ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ã€‚è¿™é‡Œæˆ‘ä»¬å°†`InitBlog`å®šä¹‰ä¸º`init_blog` ctx çš„ä¸€ç§ç±»å‹ã€‚åœ¨ ctx ç±»å‹ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»å®šä¹‰å¸æˆ·ï¼Œè¯¥å¸æˆ·å°†ç”±å®¢æˆ·ç«¯(å‡½æ•°çš„è°ƒç”¨è€…)æä¾›ã€‚

åœ¨`InitBlog`ä¸­æœ‰ 4 ä¸ªè´¦æˆ·:

*   **åšå®¢ _ è´¦å·**
    *   ç”¨äºåˆ›å»º/åˆå§‹åŒ–æ–°å¸æˆ·çš„ init å±æ€§
    *   ç©ºé—´= 8 + 32 + 32ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬æ­£åœ¨åˆ›å»ºä¸€ä¸ªæ–°å¸æˆ·ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å¿…é¡»æŒ‡å®šå¸æˆ·å¤§å°ã€‚æˆ‘ä»¬å°†åœ¨åé¢çœ‹åˆ°å¦‚ä½•è®¡ç®—å¸æˆ·å¤§å°ã€‚
    *   ä»˜æ¬¾äºº=å½“å±€ã€‚æƒé™æ˜¯å®¢æˆ·æä¾›çš„è´¦æˆ·ä¹‹ä¸€ã€‚æƒå¨æ˜¯ blog_account çš„ç§Ÿé‡‘æ”¯ä»˜è€…ã€‚
*   **åˆ›ä¸–çºª _ è¿‡è´¦ _ è´¦æˆ·**
    *   æˆ‘ä»¬è¿˜åˆ›å»ºäº†è¿™ä¸ªå¸æˆ·ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæœ‰ initã€payer å’Œ space å±æ€§
    *   ä¸ºäº†åˆ›å»º LinkedListï¼Œæˆ‘ä»¬ç”¨ç¬¬ä¸€ç¯‡æ–‡ç« åˆå§‹åŒ–åšå®¢å¸æˆ·ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å°†å®ƒé“¾æ¥åˆ°ä¸‹ä¸€ç¯‡æ–‡ç« ã€‚
*   æƒå¨
    *   ç¨‹åºç­¾åè€…æ˜¯åšå®¢çš„åˆ›å»ºè€…ã€‚
*   ç³»ç»Ÿ _ ç¨‹åº
    *   è¿è¡Œæ—¶åˆ›å»ºå¸æˆ·æ‰€éœ€çš„ã€‚

æˆ‘ä»¬çš„è®¡åˆ’æ˜¯ç”¨ current_post_key å’Œ authority ä½œä¸ºåšå®¢çŠ¶æ€æ¥åˆå§‹åŒ–åšå®¢å¸æˆ·ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ä¸ºæ­¤ç¼–å†™ä»£ç ï¼Œ

```js
  pub fn init_blog(ctx: Context<InitBlog>) -> ProgramResult {
      // get accounts from ctx
      let blog_account = &mut ctx.accounts.blog_account;
      let genesis_post_account = &mut ctx.accounts.genesis_post_account;
      let authority = &mut ctx.accounts.authority;

      // sets the blog state
      blog_account.authority = authority.key();
      blog_account.current_post_key = genesis_post_account.key();

      Ok(())
  }
```

ä½¿ç”¨ Anchor æ¡†æ¶åˆ›å»ºä¸€ä¸ªä¿å­˜ä¸€äº›çŠ¶æ€æ•°æ®çš„å¸æˆ·æ˜¯å¤šä¹ˆå®¹æ˜“ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬å°†è¿›å…¥ä¸‹ä¸€ä¸ªåŠŸèƒ½ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥åšä»€ä¹ˆï¼Ÿï¼Ÿç”¨æˆ·ï¼Œç”¨æˆ·æ³¨å†Œã€‚è®©æˆ‘ä»¬å®šä¹‰æ³¨å†ŒåŠŸèƒ½ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡è¾“å…¥å§“åå’Œå¤´åƒæ¥åˆ›å»ºä»–æˆ–å¥¹çš„ä¸ªäººèµ„æ–™ã€‚

```js
 pub fn signup_user(ctx: Context<SignupUser>) -> ProgramResult {
    Ok(())
 }
```

è¿™æ˜¯åˆ›å»ºä¸€ä¸ªæ–°åŠŸèƒ½çš„åŸºæœ¬æ¡†æ¶ï¼Œä½†ä¸‹é¢æ˜¯æˆ‘ä»¬å¦‚ä½•ä»ç”¨æˆ·é‚£é‡Œè·å¾—åå­—å’Œå¤´åƒï¼Ÿï¼Ÿè®©æˆ‘ä»¬çœ‹çœ‹ã€‚

```js
 pub fn signup_user(ctx: Context<SignupUser>, name: String, avatar: String) -> ProgramResult {
    Ok(())
 }
```

æˆ‘ä»¬å¯ä»¥æ¥å— ctx ä¹‹åä»»æ„æ•°é‡çš„å‚æ•°ï¼Œæ¯”å¦‚è¿™é‡Œçš„ name å’Œ avatar ä½œä¸ºå­—ç¬¦ä¸²(Rust æ˜¯ä¸€ç§é™æ€ç±»å‹åŒ–çš„è¯­è¨€ï¼Œæˆ‘ä»¬åœ¨å®šä¹‰å˜é‡çš„åŒæ—¶è¿˜è¦å®šä¹‰ç±»å‹)ã€‚æ¥ä¸‹æ¥æ˜¯`SignupUser` ctx ç±»å‹å’Œ`UserState`çŠ¶æ€ã€‚

```js
#[derive(Accounts)]
pub struct SignupUser<'info> {
    #[account(init, payer = authority, space = 8 + 40 + 120  + 32)]
    pub user_account: Account<'info, UserState>,
    pub authority: Signer<'info>,
    pub system_program: Program<'info, System>,
}

#[account]
pub struct UserState {
    pub name: String,
    pub avatar: String,
    pub authority: Pubkey,
}
```

è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦ä¸‰ä¸ªå¸æˆ·ï¼Œä½ å·²ç»åœ¨å‰é¢çš„å‡½æ•°ä¸­ç†è§£äº†æ‰€æœ‰çš„å±æ€§(å¦‚ initï¼Œpayerï¼Œspace ),æ‰€ä»¥ï¼Œæˆ‘åœ¨è¿™é‡Œä¸å†é‡å¤è§£é‡Šã€‚ä½†æ˜¯æˆ‘è¿™æ¬¡ä¼šç»™ä½ è§£é‡Šä¸€ä¸‹æ€ä¹ˆè®¡ç®—è´¦æˆ·ç©ºé—´ã€‚ä¸ºäº†è¡¡é‡è´¦æˆ·ç©ºé—´ï¼Œæˆ‘ä»¬éœ€è¦çœ‹ä¸€ä¸‹è´¦æˆ·çš„çŠ¶æ€ã€‚åœ¨ user_account æ¡ˆä¾‹**ä¸­ï¼ŒUserState** æœ‰ 3 ä¸ªå€¼æ¥å­˜å‚¨å§“åã€å¤´åƒå’Œæƒé™ã€‚

| çŠ¶æ€å€¼ | æ•°æ®ç±»å‹ | å¤§å°(å­—èŠ‚) |
| --- | --- | --- |
| æƒå¨ | å…¬å…±å¯†é’¥ | Thirty-two |
| åå­— | çº¿ | Forty |
| é˜¿å‡¡è¾¾ | çº¿ | One hundred and twenty |

**Pubkey:** Pubkey æ€»æ˜¯ 32 å­—èŠ‚ï¼ŒString çš„å¤§å°æ˜¯å¯å˜çš„ï¼Œè¿™å–å†³äºæ‚¨çš„ä½¿ç”¨æƒ…å†µã€‚

String: String æ˜¯ä¸€ä¸ªå­—ç¬¦æ•°ç»„ï¼Œæ¯ä¸ªå­—ç¬¦å ç”¨ rust ä¸­çš„ 4 ä¸ªå­—èŠ‚ã€‚

**è´¦æˆ·é‰´åˆ«å™¨:**æ‰€æœ‰ç”¨é”šåˆ›å»ºçš„è´¦æˆ·éœ€è¦ 8 ä¸ªå­—èŠ‚

æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬å®Œæˆå‰©ä¸‹çš„æ³¨å†ŒåŠŸèƒ½

```js
    pub fn signup_user(ctx: Context<SignupUser>, name: String, avatar: String) -> ProgramResult {
        let user_account = &mut ctx.accounts.user_account;
        let authority = &mut ctx.accounts.authority;

        user_account.name = name;
        user_account.avatar = avatar;
        user_account.authority = authority.key();

        Ok(())
    }
```

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»ç”¨åå­—å’Œå¤´åƒåˆ›å»ºäº† 2 ä¸ªå‡½æ•°`init_blog`å’Œ`signup_user`ã€‚å…·ä½“æ¥è¯´ï¼Œ`signup_user`æå‡ºäº†ä¸¤ä¸ªè®ºç‚¹ã€‚å¦‚æœç”¨æˆ·è¯¯å‘äº†é”™è¯¯çš„åå­—ï¼Œç”¨æˆ·æƒ³æ›´æ–°æ€ä¹ˆåŠï¼Ÿï¼Ÿä½ çŒœå¯¹äº†ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªåŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·æ›´æ–°å…¶å¸æˆ·çš„åç§°å’Œå¤´åƒã€‚

```js
  pub fn update_user(ctx: Context<UpdateUser>, name: String, avatar: String) -> ProgramResult {
      let user_account = &mut ctx.accounts.user_account;

      user_account.name = name;
      user_account.avatar = avatar;

      Ok(())
  }

 #[derive(Accounts)]
  pub struct UpdateUser<'info> {
      #[account(
 mut,
 has_one = authority,
 )]
      pub user_account: Account<'info, UserState>,
      pub authority: Signer<'info>,
  }
```

æ–°å±æ€§:

*   **mut:** å¦‚æœæˆ‘ä»¬æƒ³è¦æ›´æ”¹/æ›´æ–°è´¦æˆ·çŠ¶æ€/æ•°æ®ï¼Œæˆ‘ä»¬å¿…é¡»æŒ‡å®š mut å±æ€§
*   **has_one:** has_one æ£€æŸ¥ user_account.authority ç­‰äº authority accounts key ieã€‚user_account çš„æ‰€æœ‰è€…æ˜¯ update_user å‡½æ•°çš„ç­¾ç½²è€…(è°ƒç”¨æ–¹)

æˆ‘ä»¬çš„åšå®¢åˆå§‹åŒ–äº†ï¼Œç”¨æˆ·åˆ›å»ºäº†ï¼Œç°åœ¨è¿˜å‰©ä¸‹ä»€ä¹ˆï¼Ÿï¼Ÿé‚®æŠ¥çš„åƒåœ¾ã€‚åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ç ”ç©¶ post å®ä½“çš„ CRUDã€‚å¦‚æœä½ æ„Ÿåˆ°ä¸çŸ¥æ‰€æªï¼Œä¼‘æ¯ä¸€ä¸‹æˆ–è€…å¤ä¹ ä¸€ä¸‹æˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢æ‰€å­¦çš„å†…å®¹ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹å¸–å­çš„å†…å®¹å§ï¼ï¼CRUD ä»£è¡¨åˆ›å»ºè¯»å–æ›´æ–°åˆ é™¤ã€‚

```js
   pub fn create_post(ctx: Context<CreatePost>, title: String, content: String) -> ProgramResult {
        Ok(())
    }

    #[derive(Accounts)]
    pub struct CreatePost<'info> {
        #[account(init, payer = authority, space = 8 + 50 + 500 + 32 + 32 + 32)]
        pub post_account: Account<'info, PostState>,
        #[account(mut, has_one = authority)]
        pub user_account: Account<'info, UserState>,
        #[account(mut)]
        pub blog_account: Account<'info, BlogState>,
        pub authority: Signer<'info>,
        pub system_program: Program<'info, System>,
    }

    #[account]
    pub struct PostState {
        title: String,
        content: String,
        user: Pubkey,
        pub pre_post_key: Pubkey,
        pub authority: Pubkey,
    }
```

ä½ æ€ä¹ˆæƒ³å‘¢?ä¸ºä»€ä¹ˆæˆ‘ä»¬è¿™é‡Œéœ€è¦ **blog_account** ä½œä¸º mutï¼Ÿä½ è¿˜è®°å¾—**åšå®¢çŠ¶æ€**ä¸­çš„**å½“å‰ _ å‘å¸ƒ _ å¯†é’¥**å­—æ®µå—ï¼Ÿå†æ¥çœ‹å‡½æ•°ä½“ã€‚

```js
    pub fn create_post(ctx: Context<CreatePost>, title: String, content: String) -> ProgramResult {
        let blog_account = &mut ctx.accounts.blog_account;
        let post_account = &mut ctx.accounts.post_account;
        let user_account = &mut ctx.accounts.user_account;
        let authority = &mut ctx.accounts.authority;

        post_account.title = title;
        post_account.content = content;
        post_account.user = user_account.key();
        post_account.authority = authority.key();
        post_account.pre_post_key = blog_account.current_post_key;

        // store created post id as current post id in blog account
        blog_account.current_post_key = post_account.key();

        Ok(())
    }
```

å¸–å­å·²åˆ›å»ºï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥è®©å®¢æˆ·ç«¯çŸ¥é“å¸–å­å·²åˆ›å»ºã€‚å®¢æˆ·ç«¯å¯ä»¥è·å–æ–‡ç« å¹¶å°†å…¶å‘ˆç°åˆ° UI ä¸­ã€‚Anchor æä¾›äº†ä¸€ä¸ªå‘å‡ºäº‹ä»¶çš„ä¾¿åˆ©ç‰¹æ€§ã€‚ï¼Ÿæ˜¯çš„ï¼Œä½ æ²¡çœ‹é”™ã€‚æˆ‘ä»¬å¯ä»¥å‘å‡ºä¸€ä¸ªç±»ä¼¼ååˆ›å»ºçš„äº‹ä»¶ã€‚åœ¨å‘å‡ºäº‹ä»¶ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰å®ƒã€‚

```js
#[event]
pub struct PostEvent {
    pub label: String, // label is like 'CREATE', 'UPDATE', 'DELETE'
    pub post_id: Pubkey, // created post
    pub next_post_id: Option<Pubkey>, // for now ignore this, we will use this when we emit delete event
}
```

è®©æˆ‘ä»¬ä»`post_create`å‡½æ•°å‘å‡ºä¸€ä¸ª post created äº‹ä»¶

```js
    pub fn create_post(ctx: Context<CreatePost>, title: String, content: String) -> ProgramResult {
        ....

        emit!(PostEvent {
            label: "CREATE".to_string(),
            post_id: post_account.key(),
            next_post_id: None // same as null
        });

        Ok(())
    }
```

æ¥ä¸‹æ¥ï¼Œæ›´æ–°å¸–å­ã€‚

```js
    pub fn update_post(ctx: Context<UpdatePost>, title: String, content: String) -> ProgramResult {
        let post_account = &mut ctx.accounts.post_account;

        post_account.title = title;
        post_account.content = content;

        emit!(PostEvent {
            label: "UPDATE".to_string(),
            post_id: post_account.key(),
            next_post_id: None // null
        });

        Ok(())
    }

    #[derive(Accounts)]
    pub struct UpdatePost<'info> {
        #[account(
 mut,
 has_one = authority,
 )]
        pub post_account: Account<'info, PostState>,
        pub authority: Signer<'info>,
    }
```

æ›´æ–°å¸–å­éå¸¸ç®€å•ï¼Œä»ç”¨æˆ·é‚£é‡Œè·å–æ ‡é¢˜å’Œå†…å®¹ï¼Œç„¶åæ›´æ–° **mut post_account**

åˆ é™¤å¸–å­æ²¡ä»€ä¹ˆæŒ‘æˆ˜æ€§ã€‚ä¸ºäº†å­˜å‚¨å¸–å­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† LinkedListã€‚å¦‚æœä½ çŸ¥é“ LinkedListï¼Œåœ¨ä» LinkedList ä¸­åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹åï¼Œæˆ‘ä»¬éœ€è¦é“¾æ¥åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹çš„ç›¸é‚»èŠ‚ç‚¹ã€‚æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå›¾æ¥ç†è§£è¿™ä¸ªã€‚

![](img/51659a281e6d73f46389ece0557d9b09.png)

å¦‚æœæˆ‘ä»¬æƒ³åˆ é™¤ç¬¬äºŒç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å¿…é¡»é“¾æ¥ 1 -> 3ã€‚

è®©æˆ‘ä»¬è·³åˆ°ä»£ç ï¼Œæˆ‘çŸ¥é“ä½ ä¼šå¾ˆå®¹æ˜“ç†è§£å®ƒã€‚

```js
    // Here, We need two post account, current_post and next_post account. we get pre_post of current_post from current_post and link it to next_post

    pub fn delete_post(ctx: Context<DeletePost>) -> ProgramResult {
        let post_account = &mut ctx.accounts.post_account;
        let next_post_account = &mut ctx.accounts.next_post_account;

        next_post_account.pre_post_key = post_account.pre_post_key;

        emit!(PostEvent {
            label: "DELETE".to_string(),
            post_id: post_account.key(),
            next_post_id: Some(next_post_account.key())
        });

        Ok(())
    }

    #[derive(Accounts)]
    pub struct DeletePost<'info> {
        #[account(
 mut,
 has_one = authority,
 close = authority,
 constraint = post_account.key() == next_post_account.pre_post_key
 )]
        pub post_account: Account<'info, PostState>,
        #[account(mut)]
        pub next_post_account: Account<'info, PostState>,
        pub authority: Signer<'info>,
    }
```

**çº¦æŸ**å±æ€§æ‰§è¡Œç®€å•çš„ if æ£€æŸ¥ã€‚

æ‰€ä»¥è¦åˆ é™¤ä¸€ä¸ªå¸–å­ï¼Œç”¨æˆ·éœ€è¦å‘é€ post_account å’Œ next_post_accountã€‚ä½†æ˜¯å¦‚æœæ²¡æœ‰ next_post å‘¢ï¼Ÿï¼Ÿå¦‚æœç”¨æˆ·æƒ³åˆ é™¤æ²¡æœ‰ä¸‹ä¸€ç¯‡å¸–å­çš„æœ€æ–°å¸–å­æ€ä¹ˆåŠï¼Ÿï¼Ÿä¸ºäº†å¤„ç†è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºå¦ä¸€ä¸ªå‡½æ•° **delete_latest_post**

```js
    pub fn delete_latest_post(ctx: Context<DeleteLatestPost>) -> ProgramResult {
        let post_account = &mut ctx.accounts.post_account;
        let blog_account = &mut ctx.accounts.blog_account;

        blog_account.current_post_key = post_account.pre_post_key;

        emit!(PostEvent {
            label: "DELETE".to_string(),
            post_id: post_account.key(),
            next_post_id: None
        });

        Ok(())
    }

    #[derive(Accounts)]
    pub struct DeleteLatestPost<'info> {
        #[account(
 mut,
 has_one = authority,
 close = authority
 )]
        pub post_account: Account<'info, PostState>,
        #[account(mut)]
        pub blog_account: Account<'info, BlogState>,
        pub authority: Signer<'info>,
    }
```

è¿™æ˜¯æˆ‘ä»¬ Rust ç¨‹åºçš„æœ€åä¸€ä¸ªåŠŸèƒ½ã€‚

æ¥ä¸‹æ¥æ˜¯æµ‹è¯•ç¨‹åºã€‚åˆ«æ‹…å¿ƒï¼Œæˆ‘ä»¬ä¼šå¿«è¿›åˆ°ä¸‹ä¸€éƒ¨åˆ†ã€‚

# ä¸ºåšå®¢ç¨‹åºç¼–å†™æµ‹è¯•

åœ¨æˆ‘ä»¬å¼€å§‹ç¼–å†™æµ‹è¯•ç”¨ä¾‹ä¹‹å‰ï¼Œæ¯ä¸ªæµ‹è¯•éƒ½éœ€è¦ä¸€ä¸ªåˆå§‹åŒ–çš„åšå®¢ã€ä¸€ä¸ªå…¨æ–°çš„ç”¨æˆ·å’Œä¸€ç¯‡æ–‡ç« ã€‚ä¸ºäº†é¿å…é‡å¤ï¼Œæˆ‘ä»¬å°†åˆ›å»º 3 ä¸ªç®€å•çš„å¯é‡ç”¨å®ç”¨å‡½æ•°ã€‚

*   `createBlog` -åˆå§‹åŒ–æ–°çš„åšå®¢è´¦æˆ·
*   `createUser` -åˆ›å»ºæ–°ç”¨æˆ·
*   `createPost` -åˆ›å»ºæ–°å¸–å­

**createBlog.js**

```js
const anchor = require("@project-serum/anchor");

const { SystemProgram } = anchor.web3;

// we will discus the parameters when we use it
async function createBlog(program, provider) {
  const blogAccount = anchor.web3.Keypair.generate(); // creates random keypair
  const genesisPostAccount = anchor.web3.Keypair.generate(); // creates random keypair

  await program.rpc.initBlog({
    accounts: {
      authority: provider.wallet.publicKey,
      systemProgram: SystemProgram.programId,
      blogAccount: initBlogAccount.publicKey,
      genesisPostAccount: genesisPostAccount.publicKey,
    },
    signers: [initBlogAccount, genesisPostAccount],
  });

  const blog = await program.account.blogState.fetch(initBlogAccount.publicKey);

  return { blog, blogAccount, genesisPostAccount };
}

module.exports = {
  createBlog,
};
```

**createUser.js**

```js
const anchor = require("@project-serum/anchor");
const { SystemProgram } = anchor.web3;

async function createUser(program, provider) {
  const userAccount = anchor.web3.Keypair.generate();

  const name = "user name";
  const avatar = "https://img.link";

  await program.rpc.signupUser(name, avatar, {
    accounts: {
      authority: provider.wallet.publicKey,
      userAccount: userAccount.publicKey,
      systemProgram: SystemProgram.programId,
    },
    signers: [userAccount],
  });

  const user = await program.account.userState.fetch(userAccount.publicKey);
  return { user, userAccount, name, avatar };
}

module.exports = {
  createUser,
};
```

**createPost.js**

```js
const anchor = require("@project-serum/anchor");
const { SystemProgram } = anchor.web3;

async function createPost(program, provider, blogAccount, userAccount) {
  const postAccount = anchor.web3.Keypair.generate();
  const title = "post title";
  const content = "post content";

  await program.rpc.createPost(title, content, {
    // pass arguments to the program
    accounts: {
      blogAccount: blogAccount.publicKey,
      authority: provider.wallet.publicKey,
      userAccount: userAccount.publicKey,
      postAccount: postAccount.publicKey,
      systemProgram: SystemProgram.programId,
    },
    signers: [postAccount],
  });

  const post = await program.account.postState.fetch(postAccount.publicKey);
  return { post, postAccount, title, content };
}

module.exports = {
  createPost,
};
```

ç°åœ¨æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½ç¼–å†™æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹äº†ã€‚æ‰“å¼€ä½äº`/test/blog.js`ç›®å½•ä¸‹çš„æµ‹è¯•æ–‡ä»¶ã€‚æˆ‘ä»¬å°†åœ¨`blog.js`æ–‡ä»¶ä¸­ç¼–å†™æ‰€æœ‰çš„æµ‹è¯•ç”¨ä¾‹ã€‚

```js
const anchor = require("@project-serum/anchor");
const assert = require("assert");

describe("blog tests", () => {
  const provider = anchor.Provider.env();
  anchor.setProvider(provider);
  const program = anchor.workspace.BlogSol;

  it("initialize blog account", async () => {
    // call the utility function
    const { blog, blogAccount, genesisPostAccount } = await createBlog(
      program,
      provider
    );

    assert.equal(
      blog.currentPostKey.toString(),
      genesisPostAccount.publicKey.toString()
    );

    assert.equal(
      blog.authority.toString(),
      provider.wallet.publicKey.toString()
    );
  });
});
```

æ¥ä¸‹æ¥ï¼Œè¿è¡Œæµ‹è¯•:

```js
anchor test 
```

è¿è¡Œ`anchor test`åï¼Œæ‚¨å°†çœ‹åˆ° 1/1 æµ‹è¯•é€šè¿‡ã€‚

ç°åœ¨æˆ‘ä»¬å®Œæˆäº†å‰©ä½™çš„æµ‹è¯•ï¼Œæˆ‘ä»¬å°†åœ¨`blog.js`æ–‡ä»¶ä¸­å†™ä¸‹å‰ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ä¸‹é¢çš„æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹ã€‚

```js
const anchor = require("@project-serum/anchor");
const assert = require("assert");

describe("blog tests", () => {
  const provider = anchor.Provider.env();
  anchor.setProvider(provider);
  const program = anchor.workspace.BlogSol;

  it("initialize blog account", async () => {
    const { blog, blogAccount, genesisPostAccount } = await createBlog(
      program,
      provider
    );

    assert.equal(
      blog.currentPostKey.toString(),
      genesisPostAccount.publicKey.toString()
    );

    assert.equal(
      blog.authority.toString(),
      provider.wallet.publicKey.toString()
    );
  });

  it("signup a new user", async () => {
    const { user, name, avatar } = await createUser(program, provider);

    assert.equal(user.name, name);
    assert.equal(user.avatar, avatar);

    assert.equal(
      user.authority.toString(),
      provider.wallet.publicKey.toString()
    );
  });

  it("creates a new post", async () => {
    const { blog, blogAccount } = await createBlog(program, provider);
    const { userAccount } = await createUser(program, provider);

    const { title, post, content } = await createPost(
      program,
      provider,
      blogAccount,
      userAccount
    );

    assert.equal(post.title, title);
    assert.equal(post.content, content);
    assert.equal(post.user.toString(), userAccount.publicKey.toString());
    assert.equal(post.prePostKey.toString(), blog.currentPostKey.toString());
    assert.equal(
      post.authority.toString(),
      provider.wallet.publicKey.toString()
    );
  });

  it("updates the post", async () => {
    const { blog, blogAccount } = await createBlog(program, provider);
    const { userAccount } = await createUser(program, provider);
    const { postAccount } = await createPost(
      program,
      provider,
      blogAccount,
      userAccount
    );

    // now update the created post
    const updateTitle = "Updated Post title";
    const updateContent = "Updated Post content";
    const tx = await program.rpc.updatePost(updateTitle, updateContent, {
      accounts: {
        authority: provider.wallet.publicKey,
        postAccount: postAccount.publicKey,
      },
    });

    const post = await program.account.postState.fetch(postAccount.publicKey);

    assert.equal(post.title, updateTitle);
    assert.equal(post.content, updateContent);
    assert.equal(post.user.toString(), userAccount.publicKey.toString());
    assert.equal(post.prePostKey.toString(), blog.currentPostKey.toString());
    assert.equal(
      post.authority.toString(),
      provider.wallet.publicKey.toString()
    );
  });

  it("deletes the post", async () => {
    const { blogAccount } = await createBlog(program, provider);
    const { userAccount } = await createUser(program, provider);
    const { postAccount: postAcc1 } = await createPost(
      program,
      provider,
      blogAccount,
      userAccount
    );

    const { post: post2, postAccount: postAcc2 } = await createPost(
      program,
      provider,
      blogAccount,
      userAccount
    );

    const {
      post: post3,
      postAccount: postAcc3,
      title,
      content,
    } = await createPost(program, provider, blogAccount, userAccount);

    assert.equal(postAcc2.publicKey.toString(), post3.prePostKey.toString());
    assert.equal(postAcc1.publicKey.toString(), post2.prePostKey.toString());

    await program.rpc.deletePost({
      accounts: {
        authority: provider.wallet.publicKey,
        postAccount: postAcc2.publicKey,
        nextPostAccount: postAcc3.publicKey,
      },
    });

    const upPost3 = await program.account.postState.fetch(postAcc3.publicKey);
    assert.equal(postAcc1.publicKey.toString(), upPost3.prePostKey.toString());

    assert.equal(upPost3.title, title);
    assert.equal(upPost3.content, content);
    assert.equal(upPost3.user.toString(), userAccount.publicKey.toString());
    assert.equal(
      upPost3.authority.toString(),
      provider.wallet.publicKey.toString()
    );
  });
});
```

å†æ¬¡è¿è¡Œ:

```js
anchor test 
```

# å»ºç­‘å‰ç«¯

ç°åœ¨ï¼Œæˆ‘ä»¬å‡†å¤‡æ„å»ºå‰ç«¯ã€‚æˆ‘ä»¬å°†åœ¨ç°æœ‰çš„åº”ç”¨ç¨‹åºç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ react åº”ç”¨ç¨‹åºã€‚

```js
cd app
npx create-react-app . 
```

ç”¨`create-react-app`åšçš„ä¸€ä¸ªåŸºç¡€ React app çš„ç›®å½•ç»“æ„:

```js
â”œâ”€â”€ public
â”œâ”€â”€ src
|   â””â”€â”€ app.js
â”œâ”€â”€ package.json 
```

åœ¨æˆ‘ä»¬å¼€å§‹ç¼–å†™æ•™ç¨‹çš„å‰ç«¯éƒ¨åˆ†ä¹‹å‰ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªç®€å•çš„è„šæœ¬ï¼Œå°†ç¨‹åº idl æ–‡ä»¶å¤åˆ¶åˆ° React åº”ç”¨ç¨‹åºã€‚æ¯å½“æˆ‘ä»¬ä½¿ç”¨ anchor deploy éƒ¨ç½² rust ç¨‹åºæ—¶ï¼ŒAnchor CLI éƒ½ä¼šç”Ÿæˆ idl æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ä¸ rust ç¨‹åºç›¸å…³çš„æ‰€æœ‰å…ƒæ•°æ®(è¿™äº›å…ƒæ•°æ®æœ‰åŠ©äºæ„å»º Rust ç¨‹åºçš„å®¢æˆ·ç«¯æ¥å£)ã€‚

åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹åˆ›å»º`copy_idl.js`æ–‡ä»¶ï¼Œå¹¶å¤åˆ¶ä¸‹é¢ç»™å‡ºçš„ä»£ç ã€‚ä»£ç åªæ˜¯å°† idl æ–‡ä»¶ä»`/target/idl`å¤åˆ¶åˆ°`/app/src`ç›®å½•ã€‚

```js
const fs = require("fs");
const blog_idl = require("./target/idl/blog_sol.json");

fs.writeFileSync("./app/src/idl.json", JSON.stringify(blog_idl, null, 2));
```

æ¥ä¸‹æ¥ï¼Œå®‰è£…ä¾èµ–é¡¹ã€‚

```js
npm i @solana/wallet-adapter-react @solana/wallet-adapter-wallets @solana/web3.js 
```

æ¥ä¸‹æ¥ï¼Œæ‰“å¼€`app/src/App.js`å¹¶ç”¨ä»¥ä¸‹å†…å®¹æ›´æ–°å®ƒ:

```js
import {
  ConnectionProvider,
  WalletProvider,
} from "@solana/wallet-adapter-react";
import { getPhantomWallet } from "@solana/wallet-adapter-wallets";
import { Home } from "./home";

const wallets = [getPhantomWallet()];
const endPoint = "http://127.0.0.1:8899";

const App = () => {
  return (
    <ConnectionProvider endpoint={endPoint}>
      <WalletProvider wallets={wallets} autoConnect>
        <Home />
      </WalletProvider>
    </ConnectionProvider>
  );
};

export default App;
```

åœ¨æ¥ä¸‹æ¥çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†è§£é‡Šæˆ‘ä»¬çš„ dapp çš„é€»è¾‘éƒ¨åˆ†ï¼Œæˆ‘å°†æŠŠæ ·å¼éƒ¨åˆ†ç•™ç»™ä½ ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä» dapp çš„ç™»å½•åŠŸèƒ½å¼€å§‹ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæŒ‰é’®ï¼Œå¤„ç†ä¸å¹»å½±æµè§ˆå™¨é’±åŒ…ç”¨æˆ·ç™»å½•ã€‚

ç”¨è¿™æ ·çš„ onClick å¤„ç†ç¨‹åºåœ¨ Home.js ç»„ä»¶ä¸­åˆ›å»ºæŒ‰é’®ï¼Œ

```js
<button onClick={onConnect}>Connect with Phantom</button>
```

ç„¶ååˆ›å»ºå¤„ç†è¿æ¥æŒ‰é’®ç‚¹å‡»äº‹ä»¶çš„`onConnect`å‡½æ•°ã€‚

```js
import { WalletName } from "@solana/wallet-adapter-wallets";
import { useWallet } from "@solana/wallet-adapter-react";

// inside react component
const { select } = useWallet();
const onConnect = () => {
  select(WalletName.Phantom);
};
```

è®©æˆ‘ä»¬é¦–å…ˆéƒ¨ç½²æˆ‘ä»¬çš„ Rust ç¨‹åºï¼Œç„¶ååœ¨æˆ‘ä»¬ä¹‹å‰ç¼–å†™çš„`copy_idl.js`è„šæœ¬çš„å¸®åŠ©ä¸‹å¤åˆ¶ idl æ–‡ä»¶ï¼Œ

åœ¨éƒ¨ç½²ä¹‹å‰ï¼Œç¡®ä¿åœ¨ Anchor.toml æ–‡ä»¶ä¸­è®¾ç½®äº†`localnet`é›†ç¾¤ã€‚ç°åœ¨æ‰“å¼€ä¸€ä¸ªæ–°çš„ç»ˆç«¯ä¼šè¯å¹¶è¿è¡Œ`solana-test-validator`å‘½ä»¤ã€‚è¿™å°†å¯åŠ¨ä¸€ä¸ªæœ¬åœ°çš„ç´¢æ‹‰çº³åŒºå—é“¾ç½‘ç»œã€‚

```js
solana-test-validator 
```

ç„¶åéƒ¨ç½²ç¨‹åºï¼Œ

```js
anchor deploy 
```

å¦‚æœä½ é‡åˆ°é”™è¯¯ï¼Œ

*   ç¡®ä¿`solana-test-validator`æ­£åœ¨è¿è¡Œ
*   ç¡®ä¿æ‚¨çš„ Solana é…ç½®å¤„äºæœ‰æ•ˆçŠ¶æ€(æˆ‘æŒ‡çš„æ˜¯ RPC urlã€å¯†é’¥å¯¹è·¯å¾„ç­‰ã€‚)

ä¸€æ—¦ä½¿ç”¨ anchor CLI æˆåŠŸéƒ¨ç½² Rust ç¨‹åºï¼Œç„¶åè¿è¡Œ`copy_idl.js`æ–‡ä»¶ï¼Œ

```js
node copy_idl.js 
```

å®ƒä¼šå°† idl æ–‡ä»¶å¤åˆ¶åˆ°`/app/src`ç›®å½•ï¼Œç°åœ¨ä½ ä¼šåœ¨`/app/src`ç›®å½•ä¸­çœ‹åˆ°`idl.json`æ–‡ä»¶ã€‚

## åˆå§‹åŒ–åšå®¢

ç°åœ¨æˆ‘ä»¬å°†åˆå§‹åŒ–åšå®¢ã€‚åˆå§‹åŒ–åšå®¢æ˜¯ä¸€æ¬¡æ€§çš„è¿‡ç¨‹ã€‚è®©æˆ‘ä»¬åœ¨`/app/src`æ–‡ä»¶å¤¹ä¸­åˆ›å»º`init_blog.js`æ–‡ä»¶ï¼Œå¹¶å¤åˆ¶ä¸‹é¢ç»™å‡ºçš„ä»£ç ã€‚

```js
import { Program } from "@project-serum/anchor";
import { Keypair, PublicKey, SystemProgram } from "@solana/web3.js";
import idl from "./idl.json";

const PROGRAM_KEY = new PublicKey(idl.metadata.address);

export async function initBlog(walletKey, provider) {
  const program = new Program(idl, PROGRAM_KEY, provider);
  const blogAccount = Keypair.generate();
  const genesisPostAccount = Keypair.generate();

  await program.rpc.initBlog({
    accounts: {
      authority: walletKey,
      systemProgram: SystemProgram.programId,
      blogAccount: blogAccount.publicKey,
      genesisPostAccount: genesisPostAccount.publicKey,
    },
    signers: [blogAccount, genesisPostAccount],
  });

  console.log("Blog pubkey: ", blogAccount.publicKey.toString());
}
```

åœ¨è¿™ä¸ª`initBlog`å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯¼å…¥äº†ç¨‹åº idlï¼Œç„¶åæˆ‘ä»¬ä¸ºåšå®¢å¸æˆ·å’Œåˆå§‹è™šæ‹Ÿå¸–å­å¸æˆ·ç”Ÿæˆäº†ä¸¤ä¸ªå¯†é’¥å¯¹ï¼Œä¹‹åæˆ‘ä»¬åªéœ€è°ƒç”¨ç¨‹åºçš„ initBlog å‡½æ•°å’Œæ‰€æœ‰å¿…è¦çš„å¸æˆ·ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œåˆ›å»ºä¸¤ä¸ªæ–°è´¦æˆ·`blogAccount`å’Œ`genesisPostAccount`ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å¿…é¡»ä½œä¸ºç­¾ç½²è€…é€šè¿‡å®ƒã€‚

ç°åœ¨ UI éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªä¸´æ—¶æŒ‰é’®æ¥è°ƒç”¨`initBlog`å‡½æ•°ã€‚ä¸€æ—¦åšå®¢åˆå§‹åŒ–ï¼Œæˆ‘ä»¬å°†åˆ é™¤æŒ‰é’®ï¼Œå› ä¸ºå®ƒå°†ä¸å†éœ€è¦ã€‚

```js
  import {
    useAnchorWallet,
    useConnection
  } from "@solana/wallet-adapter-react";
  import idl from './idl.json'

  const PROGRAM_KEY = new PublicKey(idl.metadata.address);
  const BLOG_KEY = /* new PublicKey(blog key) */;

  // inside react component
  const { connection } = useConnection();
  const wallet = useAnchorWallet();

  const _initBlog = () => {
    const provider = new Provider(connection, wallet, {});
    initBlog(provider.wallet.publicKey, provider);
  };

  <button onClick={_initBlog}>Init blog</button>
```

`initBlog`å‡½æ•°å°†åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„åšå®¢å¹¶æ§åˆ¶å°è®°å½•å®ƒçš„å…¬é’¥ã€‚ç¡®ä¿æ‚¨ä»åœ¨å¦ä¸€ä¸ªç»ˆç«¯è¿è¡Œ`solana-test-validator`ï¼Œå¹¶ä¸”æ‚¨çš„è™šæ‹Ÿé’±åŒ…å·²è¿æ¥åˆ°æœ¬åœ°ç½‘ç»œ(`http://localhost:8899`

å¦‚æœæ‚¨ä¸çŸ¥é“å¦‚ä½•å°†è™šæ‹Ÿé’±åŒ…è¿æ¥åˆ° Localnetï¼Œ

*   è½¬åˆ°è™šæ‹Ÿé’±åŒ…ä¸­çš„è®¾ç½®é€‰é¡¹å¡
*   å‘ä¸‹æ»šåŠ¨å¹¶é€‰æ‹©**æ”¹å˜ç½‘ç»œ**
*   æœ€åé€‰æ‹© **Localhost**

æ¥ä¸‹æ¥ï¼Œæ‚¨éœ€è¦ Localnet ä¸Šçš„å¸æˆ·ä½™é¢ã€‚è¦è·å¾—ä½™é¢ï¼Œæ‚¨éœ€è¦è¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚

```js
solana airdrop 1 <your-account-address> 
```

ç„¶åä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥æ‚¨çš„å¸æˆ·ä½™é¢:

```js
solana balance <your-account-address> 
```

ä½ ä¼šçœ‹åˆ°`1 SOL`æ‰“å°åœ¨ä½ çš„ç»ˆç«¯ä¸Šã€‚

ä¸€æ—¦è¿æ¥åˆ°æœ¬åœ°ä¸»æœºï¼Œå°±å¯ä»¥åˆå§‹åŒ–åšå®¢å¸æˆ·äº†ã€‚ç”¨`npm run start`è¿è¡Œåº”ç”¨ç¨‹åºï¼Œå®ƒä¼šåœ¨ä½ çš„æµè§ˆå™¨ä¸­æ‰“å¼€ä½ çš„ Dappï¼Œä½ ä¼šçœ‹åˆ°ä¸¤ä¸ªæŒ‰é’®ï¼Œä¸€ä¸ªæ˜¯`connect`ï¼Œå¦ä¸€ä¸ªæ˜¯`init blog`ã€‚ç¬¬ä¸€æ­¥æ˜¯é€šè¿‡ç‚¹å‡»`connect`æŒ‰é’®è¿æ¥åˆ°è™šæ‹Ÿé’±åŒ…ã€‚ä¸€æ—¦ä½ è¿æ¥ä¸Šï¼Œç„¶åç‚¹å‡»`init blog`æŒ‰é’®ã€‚å®ƒå°†è§¦å‘è™šæ‹Ÿé’±åŒ…ç¡®è®¤å¼¹å‡ºç‚¹å‡»`Approve`ã€‚1 åˆ° 2 ç§’åï¼Œ`initBlog`å‡½æ•°å°†æ§åˆ¶å°è®°å½•ä½ çš„åšå®¢å¸æˆ·çš„å…¬é’¥ï¼Œåªéœ€å¤åˆ¶åšå®¢å…¬é’¥å¹¶å°†å…¶å­˜å‚¨åœ¨`BLOG_KEY`å˜é‡ä¸­å³å¯ã€‚æˆ‘ä»¬å·²ç»æˆåŠŸåˆå§‹åŒ–äº†æˆ‘ä»¬çš„åšå®¢å¸æˆ·ã€‚

```js
const BLOG_KEY = new PublicKey(your - blog - key);
```

ä½ çš„åšå®¢å·²ç»åˆå§‹åŒ–äº†ï¼Œç°åœ¨ä½ å¯ä»¥æ³¨é‡Šæ‰`init blog`æŒ‰é’®å’Œ`_initBlog`å‡½æ•°ã€‚

## æ³¨å†Œç”¨æˆ·

ç°åœ¨æˆ‘ä»¬å°†ç§»åŠ¨åˆ°ç”¨æˆ·è¾“å…¥ä»–/å¥¹çš„åå­—å’Œå¤´åƒ URL çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†åˆå§‹åŒ–ä»–/å¥¹çš„å¸æˆ·ã€‚

è®©æˆ‘ä»¬åˆ›å»ºä¸¤ä¸ªè¾“å…¥å­—æ®µï¼Œä¸€ä¸ªç”¨äºç”¨æˆ·åï¼Œå¦ä¸€ä¸ªç”¨äºç”¨æˆ·å¤´åƒã€‚

```js
 <input placeholder="user name" />
 <input placeholder="user avatar" />
```

æ¥ä¸‹æ¥å°† React çŠ¶æ€é™„åŠ åˆ°è¾“å…¥å­—æ®µå¹¶åˆ›å»º`signup`æŒ‰é’®

```js
 const [name, setName] = useState("")
 const [avatar, setAvatar] = useState("")

 const _signup = ()=> {

 }

 <input placeholder="user name" value={name} onChange={e => setName(e.target.value)} />
 <input placeholder="user avatar" value={avatar} onChange={e => setAvatar(e.target.value)} />
 <button onClick={_signup}>Signup</button>
```

ç°åœ¨æˆ‘ä»¬å°†ç¼–å†™`_signup`å‡½æ•°çš„åŠŸèƒ½ï¼Œå¦‚æœæ‚¨è¿˜è®°å¾—`initBlog`å‡½æ•°ï¼Œæˆ‘ä»¬å·²ç»éšæœºç”Ÿæˆäº†å¯†é’¥å¯¹ï¼Œä½†åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸ä¼šéšæœºç”Ÿæˆå¯†é’¥å¯¹ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦ä¸ºæ‰€æœ‰åç»­ç™»å½•è¯†åˆ«ç”¨æˆ·ã€‚

`Keypair`æœ‰ä¸€ä¸ª`fromSeed`å‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ª`seed`å‚æ•°ï¼Œå¹¶æ ¹æ®ç»™å®šçš„ç§å­ç”Ÿæˆä¸€ä¸ªæƒŸä¸€çš„å¯†é’¥å¯¹ã€‚

å› æ­¤ï¼Œæˆ‘ä»¬å°†é€šè¿‡ç»„åˆ`PROGRAM_KEY`å’Œç”¨æˆ·`wallet_key`æ¥åˆ›å»ºä¸€ä¸ªç§å­ï¼Œè¿™æ ·å®ƒå°†åˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„å¯†é’¥å¯¹ã€‚

```js
import { Keypair, PublicKey, SystemProgram } from "@solana/web3.js";
import { Program, Provider } from "@project-serum/anchor";

const genUserKey = (PROGRAM_KEY, walletKey) => {
  const userAccount = Keypair.fromSeed(
    new TextEncoder().encode(
      `${PROGRAM_KEY.toString().slice(0, 15)}__${walletKey
 .toString()
 .slice(0, 15)}`
    )
  );

  return userAccount;
};
```

è®©æˆ‘ä»¬å®Œæˆ`_signup`å‡½æ•°ï¼Œ

```js
const _signup = async () => {
  const provider = new Provider(connection, wallet, {});
  const program = new Program(idl, PROGRAM_KEY, provider);
  const userAccount = genUserKey(PROGRAM_KEY, provider.wallet.publicKey);

  await program.rpc.signupUser(name, avatar, {
    accounts: {
      authority: provider.wallet.publicKey,
      userAccount: userAccount.publicKey,
      systemProgram: SystemProgram.programId,
    },
    signers: [userAccount],
  });
};
```

ç°åœ¨æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ç”¨æˆ·å¸æˆ·ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†è·å–ç”¨æˆ·å¸æˆ·ï¼Œä»¥æŸ¥çœ‹ç”¨æˆ·æ˜¯å¦å·²ç»æ³¨å†Œã€‚

```js
import { useEffect, useState } from "react";

// inside react component
const fetchUser = async () => {
  const provider = new Provider(connection, wallet, {});
  const program = new Program(idl, PROGRAM_KEY, provider);
  const userAccount = genUserKey(PROGRAM_KEY, provider.wallet.publicKey);

  const _user = await program.account.userState.fetch(userAccount.publicKey);

  return _user;
};

const [user, setUser] = useState();
// fetch user when wallet is connected
useEffect(() => {
  if (wallet?.publicKey) {
    fetchUser()
      .then((user) => {
        setUser(user);
      })
      .catch((e) => console.log(e));
  }
}, [wallet]);

// if the user is not undefined then show user name and user avatar in UI
// otherwise show signup form to the user

{
  user ? (
    <>
      <h1>user name: {user.name}</h1>
      <h1>user avatar: {user.avatar} </h1>
    </>
  ) : (
    <>
      <input
        placeholder="user name"
        value={name}
        onChange={(e) => setName(e.target.value)}
      />
      <input
        placeholder="user avatar"
        value={avatar}
        onChange={(e) => setAvatar(e.target.value)}
      />
      <button onClick={_signup}>Signup</button>{" "}
    </>
  );
}
```

## åˆ›å»ºå¸–å­

é¦–å…ˆï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªè¡¨å•ï¼Œä»ç”¨æˆ·è¾“å…¥ä¸­è·å–æ–‡ç« æ ‡é¢˜å’Œæ–‡ç« å†…å®¹ã€‚

```js
    const [title, setTitle] = useState("");
    const [content, setContent] = useState("");

     const _createPost = async ()=> {

     }

    <input
      placeholder="post title"
      value={title}
      onChange={(e) => setTitle(e.target.value)}
    />
    <input
      placeholder="post content"
      value={content}
      onChange={(e) => setContent(e.target.value)}
    />
    <button onClick={_createPost}>Create post</button>
```

ç°åœ¨æˆ‘ä»¬å¯ä»¥å®Œæˆ`_createPost`åŠŸèƒ½äº†

```js
const _createPost = async () => {
  const provider = new Provider(connection, wallet, {});
  const program = new Program(idl, PROGRAM_KEY, provider);
  const postAccount = Keypair.generate();
  const userAccount = genUserKey(PROGRAM_KEY, provider.wallet.publicKey);

  await program.rpc.createPost(title, content, {
    accounts: {
      blogAccount: BLOG_KEY,
      authority: provider.wallet.publicKey,
      userAccount: userAccount.publicKey,
      postAccount: postAccount.publicKey,
      systemProgram: SystemProgram.programId,
    },
    signers: [postAccount],
  });
};
```

è¿™é‡Œï¼Œæˆ‘ä»¬ä¼ é€’äº†ä¸åˆå§‹åŒ–åšå®¢æ—¶è·å¾—çš„å¯†é’¥ç›¸åŒçš„å¯†é’¥ã€‚

ç°åœ¨æˆ‘ä»¬å°†è·å–åœ¨æˆ‘ä»¬çš„åšå®¢ä¸Šåˆ›å»ºçš„æ‰€æœ‰å¸–å­ã€‚å¦‚æœæ‚¨è¿˜è®°å¾— Rust ç¨‹åºï¼Œæˆ‘ä»¬å·²ç»å°†ä»¥å‰çš„å¸–å­ id é™„åŠ åˆ°äº†å½“å‰å¸–å­ï¼Œè¿™é‡Œæˆ‘ä»¬å°†ä½¿ç”¨ä»¥å‰çš„å¸–å­ id æ¥è¿­ä»£å¸–å­åˆ—è¡¨ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå‡½æ•°æ¥æŸ¥æ‰¾ç»™å®šå¸–å­ id çš„å¸–å­ã€‚

```js
const getPostById = async (postId) => {
  const provider = new Provider(connection, wallet, {});
  const program = new Program(idl, PROGRAM_KEY, provider);

  try {
    const post = await program.account.postState.fetch(new PublicKey(postId));

    const userId = post.user.toString();
    if (userId === SystemProgram.programId.toString()) {
      return;
    }

    return {
      id: postId,
      title: post.title,
      content: post.content,
      userId,
      prePostId: post.prePostKey.toString(),
    };
  } catch (e) {
    console.log(e.message);
  }
};
```

ä¸ºäº†å¾ªç¯æ‰€æœ‰çš„æ–‡ç« ï¼Œæˆ‘ä»¬éœ€è¦æœ€æ–°çš„æ–‡ç«  idï¼Œæˆ‘ä»¬å¯ä»¥ä»åšå®¢çŠ¶æ€ä¸­æ‰¾åˆ°æœ€æ–°çš„æ–‡ç«  idã€‚åˆ›å»º`fetchAllPosts`åŠŸèƒ½ä¸ºï¼Œ

```js
const fetchAllPosts = async () => {
  const provider = new Provider(connection, wallet, {});
  const program = new Program(idl, PROGRAM_KEY, provider);

  // read the blog state
  const blog = await program.account.blogState.fetch(BLOG_KEY);

  const latestPostId = blog.currentPostKey.toString();
  const posts = [];

  let nextPostId = latestPostId;
  while (!!nextPostId) {
    const post = await getPostById(nextPostId, program);
    if (!post) {
      break;
    }

    posts.push(post);
    nextPostId = post.prePostId;
  }

  return posts;
};
```

ç°åœ¨ï¼Œå½“ç”¨æˆ·ä½¿ç”¨è™šæ‹Ÿé’±åŒ…ç™»å½•æ—¶ï¼Œè§¦å‘ fetchAllPosts å‡½æ•°ã€‚

```js
const [posts, setPosts] = useState([]);

// fetch all the posts when wallet is connected
useEffect(() => {
  if (wallet?.publicKey) {
    fetchAllPosts()
      .then((posts) => {
        setPosts(posts);
      })
      .catch((e) => console.log(e));
  }
}, [wallet]);
```

åœ¨ç”¨æˆ·ç•Œé¢ä¸­æ˜¾ç¤ºå¸–å­

```js
{
  posts.map(({ title, content }, i) => {
    return (
      <div key={i}>
        <h2>{title}</h2>
        <p>{content}</p>
      </div>
    );
  });
}
```

## å¾…åŠäº‹é¡¹

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»é›†æˆäº†åšå®¢çš„åˆå§‹åŒ–ï¼Œç”¨æˆ·æ³¨å†Œï¼Œè·å–ç”¨æˆ·ï¼Œåˆ›å»ºå¸–å­ï¼Œè·å–æ‰€æœ‰å¸–å­ï¼Œè¿˜æœ‰ä¸€äº›éƒ¨åˆ†ä»ç„¶å­˜åœ¨ï¼Œ

*   æ›´æ–°ç”¨æˆ·
*   æ›´æ–°å¸–å­
*   åˆ é™¤å¸–å­

å¦‚æœä½ æŒ‰ç…§æˆ‘ä»¬æ‰€å­¦çš„æ­¥éª¤å»åšï¼Œä½ å°±èƒ½å®Œæˆå‰©ä¸‹çš„ä»»åŠ¡ã€‚

## éƒ¨ç½²åˆ° Devnet

éƒ¨ç½²åˆ°å®æ—¶ç½‘ç»œéå¸¸ç®€å•:

1.  å°† Solana é…ç½®è®¾ç½®ä¸º devnet

```js
solana config set --url devnet 
```

2.  æ‰“å¼€ Anchor.toml å¹¶å°†é›†ç¾¤æ›´æ–°åˆ° devnet

```js
cluster = "devnet"
```

3.  æ„å»ºç¨‹åº

```js
anchor build 
```

4.  éƒ¨ç½²ç¨‹åº

```js
anchor deploy 
```

# ç»“è®º

ç¥è´ºä½ å®Œæˆæ•™ç¨‹ã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å·²ç»æˆåŠŸåœ°ä¸º Solana åŒºå—é“¾ä¸Šçš„åšæ–‡ Dapp åˆ›å»ºäº†ä¸€ä¸ª Rust ç¨‹åºã€‚æˆ‘ä»¬è¿˜åœ¨å®¢æˆ·ç«¯é›†æˆäº†åšå®¢å¸–å­ Rust ç¨‹åºå’Œ React.jsã€‚è¿™é‡Œï¼Œæˆ‘ä»¬é‡‡ç”¨äº†ä¸€ç§ç¨å¾®ä¸åŒçš„æ–¹æ³•æ¥å­˜å‚¨å’Œæ£€ç´¢æ–‡ç« ã€‚ç´¢æ‹‰çº³åŒºå—é“¾ä»å¤„äºæµ‹è¯•é˜¶æ®µï¼Œæ‰€ä»¥ä¸è¦è´¹å¿ƒå»å°è¯•ã€‚è°çŸ¥é“å‘¢ï¼Œä½ å¯èƒ½ä¼šä»ä¸­å‘ç°ä¸€äº›å¾ˆé…·çš„å›¾æ¡ˆã€‚

åšå®¢ Dapp è¿˜æœ‰æ”¹è¿›çš„ç©ºé—´ï¼Œ

*   UI æ”¹è¿›
*   ä½¿ç”¨ Typescript åˆ›å»ºå‰ç«¯åº”ç”¨ç¨‹åº
*   è·å–æ‰€æœ‰æ–‡ç« æ—¶æ·»åŠ åˆ†é¡µ
*   åˆ›å»ºç”¨æˆ·æ—¶é—´è¡¨(ç”¨æˆ·åˆ›å»ºçš„å¸–å­)
*   æ·»åŠ  Rxjs ä»¥è·å–å¸–å­(æµå¸–å­)

# å…³äºä½œè€…

æœ¬æ•™ç¨‹ç”± [Kiran Bhalerao](https://github.com/kiran-bhalerao) åˆ›ä½œã€‚å¯¹äºä»»ä½•å»ºè®®/é—®é¢˜ï¼Œæ‚¨å¯ä»¥é€šè¿‡ [twitter](https://twitter.com/_KiranBhalerao) ä¸ä½œè€…è”ç³»ã€‚

# å‚è€ƒ

[https://github.com/kiran-bhalerao/blog-dapp-Solana](https://github.com/kiran-bhalerao/blog-dapp-Solana)