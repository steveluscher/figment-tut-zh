# polygon/Build-a-NFT-Marketplace-using-HardHat

> åŸæ–‡ï¼š<https://github.com/figment-networks/learn-tutorials/blob/master/polygon/Build-a-NFT-Marketplace-using-HardHat.md>

# ä»‹ç»

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•å»ºç«‹ä¸€ä¸ª NFT å¸‚åœºæ™ºèƒ½åˆåŒã€‚æˆ‘ä»¬çš„å¸‚åœºæ™ºèƒ½åˆåŒå°†ä½¿å…¶ç”¨æˆ·æ”¯ä»˜å°‘é‡è´¹ç”¨å°±å¯ä»¥åœ¨åˆåŒä¸Šåˆ—å‡ºä»–ä»¬çš„ NFTã€‚è¿™ä¸ª NFT å¸‚åœºæ˜¯ä¸€ä¸ªåª’ä»‹ï¼Œäººä»¬å¯ä»¥åœ¨è¿™é‡Œä¹°å–ä»–ä»¬çš„éåŠŸèƒ½æ€§é£Ÿç‰©ã€‚æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ç¼–å†™å•å…ƒæµ‹è¯•ï¼Œå¦‚ä½•ä½¿ç”¨ HardHat å°†æˆ‘ä»¬çš„åˆåŒéƒ¨ç½²åˆ° Polygon Mumbai testnetï¼Œä»¥åŠå¦‚ä½•åœ¨ Polygonscan ä¸ŠéªŒè¯åˆåŒæºä»£ç ï¼Œä»¥ä¾¿å®ƒæ˜¯å…¬å¼€å¯ç”¨çš„ã€‚

# å…ˆå†³æ¡ä»¶

æœ¬æ•™ç¨‹å‡è®¾æ‚¨å·²ç»å®Œæˆäº†[ä¸ HardHat åˆ›å»º NFT æ™ºèƒ½åˆåŒ](https://learn.figment.io/tutorials/create-nft-smart-contract-with-hardhat)æ•™ç¨‹ã€‚æˆ‘ä»¬ä½¿ç”¨è¯¥é¡¹ç›®æ„å»ºä½œä¸ºæœ¬æ•™ç¨‹çš„èµ·ç‚¹ã€‚è™½ç„¶æ²¡æœ‰å¿…è¦å®Œæˆè¯¥æ•™ç¨‹ï¼Œä½†å®ƒå°†è®©æ‚¨æ›´å¥½åœ°äº†è§£ç¯å¢ƒè®¾ç½®ä»¥åŠå¦‚ä½•ä½¿ç”¨ HardHat æ„å»ºæ™ºèƒ½åˆçº¦ã€‚

# è¦æ±‚

*   [Node.js](https://nodejs.org/en/) v14.17.6 LTS æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œç”¨äºå®‰è£…åŒ…ã€‚
*   [HardHat](https://hardhat.org/) æ˜¯æˆ‘ä»¬å°†ç”¨äºå¼€å‘æ™ºèƒ½åˆåŒçš„æ¡†æ¶ã€‚
*   [å…ƒæ©ç ](https://metamask.io/)ç”¨äºä¸åŒºå—é“¾äº¤äº’ã€‚
    *   ä¸€æ—¦ä½ å®‰è£…äº† MetaMaskï¼Œæ·»åŠ ä¸€ä¸ªä¸ [Polygon Mumbai Testnet](https://docs.matic.network/docs/develop/metamask/config-polygon-on-metamask) çš„è¿æ¥ã€‚
    *   è®°å¾—ä½¿ç”¨[å¤šè¾¹å½¢é¾™å¤´](https://faucet.polygon.technology/)å‘æ‚¨çš„è´¦æˆ·æ³¨å…¥ testnet MATIC ä»£å¸ã€‚
*   ä¸€ä¸ª [Polygonscan API å¯†é’¥](https://polygonscan.com/login?cmd=last)ï¼Œå®ƒå°†ç”¨äºä½¿ç”¨ä¸€ä¸ª HardHat æ’ä»¶åœ¨ Polygonscan ä¸Šè‡ªåŠ¨éªŒè¯æˆ‘ä»¬çš„æ™ºèƒ½åˆåŒæºä»£ç ã€‚

# ç¯å¢ƒè®¾ç½®

æˆ‘ä»¬å°†é¦–å…ˆåˆ›å»ºä¸€ä¸ªç©ºçš„ HardHat é¡¹ç›®ã€‚

åˆ›å»ºä¸€ä¸ªåä¸º`art_marketplace`çš„æ–°ç›®å½•ï¼Œç”¨`cd`å‘½ä»¤åˆ‡æ¢åˆ°è¿™ä¸ªç›®å½•ï¼Œç„¶åè¿è¡Œ`npx hardhat`æ¥åˆå§‹åŒ– HardHat é¡¹ç›®ã€‚

`npx hardhat`å‘½ä»¤ä¼šç»™ä½ ä¸€ä¸ªèœå•ï¼Œåœ¨è¿™é‡Œä½ å¯ä»¥é€‰æ‹©å¦‚ä½•åˆå§‹åŒ–ä½ çš„é¡¹ç›®

[![npx_hardhat.png](img/b08b2a69d360540b0f98809368366b95.png)](https://github.com/figment-networks/learn-tutorials/raw/master/assets/npx_hardhat_basic.png)

æˆ‘ä»¬å°†ä»é›¶å¼€å§‹ã€‚ä½¿ç”¨é”®ç›˜ä¸Šçš„ç®­å¤´é”®ï¼Œé€‰æ‹©`Create an empty hardhat.config.js`é€‰é¡¹å¹¶æŒ‰ Enter é”®ã€‚

è¿™å°†åˆ›å»ºä¸€ä¸ªç©ºçš„`hardhat.config.js`æ–‡ä»¶å’Œä¸€ä¸ª`package.json`æ–‡ä»¶ã€‚æˆ‘ä»¬å·²ç»åœ¨ä¹‹å‰çš„æ•™ç¨‹[ä¸­è¯¦ç»†è®¨è®ºäº†è¿™ä¸ªæ–‡ä»¶çš„ä½¿ç”¨ï¼Œåˆ›å»ºä¸€ä¸ªå¸¦æœ‰å®‰å…¨å¸½çš„ NFT æ™ºèƒ½åˆåŒ](https://learn.figment.io/tutorials/create-nft-smart-contract-with-hardhat)ã€‚`package.json`åŒ…å«äº†æˆ‘ä»¬å®‰è£…çš„æ‰€æœ‰`npm`åŒ…ã€‚åœ¨ç»§ç»­ä¹‹å‰ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€äº›æ–‡ä»¶å¤¹æ¥ç»„ç»‡æˆ‘ä»¬çš„å·¥ä½œã€‚åœ¨ç»ˆç«¯ä¸­é”®å…¥ä»¥ä¸‹å†…å®¹:

```js
mkdir contracts    # This directory will contain all the smart contract code
mkdir scripts      # This directory will store the scripts we write
mkdir test         # This directory will store all the test scripts we write
touch .env         # This file will store all our private keys
touch .gitignore   # This file will list all the files that are to ignore by the version control system
touch README.md    # The README file for our project which contains descriptive information about it
```

[![Folder Structure](img/c67bf00fc5e0417c214d5d566a6f9154.png)](https://github.com/figment-networks/learn-tutorials/raw/master/assets/FolderStructure_hh.png)

ç°åœ¨ï¼Œå¦‚æœä½ åœ¨ä½ æœ€å–œæ¬¢çš„ä»£ç ç¼–è¾‘å™¨ä¸­æ‰“å¼€å·¥ä½œç›®å½•(æˆ‘ç”¨çš„æ˜¯ VSCode)ï¼Œæ–‡ä»¶ç»“æ„åº”è¯¥çœ‹èµ·æ¥åƒè¿™æ ·

ç°åœ¨æˆ‘ä»¬å¿…é¡»å®‰è£…é¡¹ç›®æ‰€éœ€çš„ä¾èµ–é¡¹ã€‚å°†ä»¥ä¸‹å†…å®¹å¤åˆ¶åˆ° package.json æ–‡ä»¶ä¸­:

```js
{
  "name": "hardhat-project",
  "devDependencies": {
    "@nomiclabs/hardhat-ethers": "^2.0.2",
    "@nomiclabs/hardhat-waffle": "^2.0.1",
    "chai": "^4.3.4",
    "ethereum-waffle": "^3.4.0",
    "ethers": "^5.4.6",
    "hardhat": "^2.6.4"
  },
  "dependencies": {
    "@nomiclabs/hardhat-etherscan": "^2.1.6",
    "@openzeppelin/contracts": "^4.3.2",
    "dotenv": "^10.0.0"
  }
}
```

ç°åœ¨è¿è¡Œä»¥ä¸‹å‘½ä»¤:

```js
npm install 
```

æ­¤å‘½ä»¤å°†å®‰è£…é¡¹ç›®æ‰€éœ€çš„æ‰€æœ‰ä»£ç åº“ã€‚æ‰€æœ‰å®‰è£…çš„æ¨¡å—éƒ½å¯ä»¥åœ¨åä¸º`node_modules`çš„æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°ã€‚

æ­å–œ<g-emoji class="g-emoji" alias="tada" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f389.png">ğŸ‰</g-emoji> <g-emoji class="g-emoji" alias="tada" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f389.png">ğŸ‰</g-emoji> <g-emoji class="g-emoji" alias="tada" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f389.png">ğŸ‰</g-emoji>ï¼Œä½ ç°åœ¨å·²ç»å‡†å¤‡å¥½å¼€å§‹æ’°å†™æ™ºèƒ½åˆåŒäº†ã€‚

# å¼€å‘æ™ºèƒ½åˆåŒ

åœ¨`contracts`æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªåä¸º`Marketplace.sol`çš„æ–°æ–‡ä»¶ã€‚æˆ‘ä»¬çš„æ™ºèƒ½å¥‘çº¦çš„æ–‡ä»¶ååº”è¯¥ä»¥æŸç§æ–¹å¼è¡¨æ˜å®ƒçš„åŠŸèƒ½ï¼Œå°½ç®¡æ–‡ä»¶åå®Œå…¨æ˜¯æ‚¨è‡ªå·±é€‰æ‹©çš„ã€‚

```js
// SPDX-License-Identifier: Unlicensed

pragma solidity 0.8.4;

contract Marketplace {
}
```

æˆ‘ä»¬é¦–å…ˆå®šä¹‰æ™ºèƒ½åˆçº¦çš„è®¸å¯è¯ã€‚å‡ºäºæœ¬æ•™ç¨‹çš„ç›®çš„ï¼Œæˆ‘ä»¬å°†ä¿æŒæˆ‘ä»¬çš„åˆåŒä¸º`Unlicensed`ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç”¨å…³é”®å­—`pragma`å®šä¹‰æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨çš„å®åº¦ç‰ˆæœ¬ã€‚æˆ‘ä»¬å°†ä½¿ç”¨å›ºä½“ç‰ˆæœ¬`0.8.4`ã€‚æˆ‘ä»¬è¿˜ä½¿ç”¨`contract`å…³é”®å­—å®šä¹‰äº†æ™ºèƒ½åˆçº¦çš„åç§°ã€‚è¯·ç¡®ä¿å®šä¹‰çš„åˆåŒåç§°ä¸æ‚¨åˆ›å»ºçš„æ–‡ä»¶åç§°ç›¸åŒ¹é…ã€‚

## å¯¼å…¥åº“

å°†ä»¥ä¸‹å¯¼å…¥è¯­å¥æ·»åŠ åˆ°ä»£ç ä¸­:

```js
// SPDX-License-Identifier: Unlicensed

pragma solidity 0.8.4;

import "@openzeppelin/contracts/token/ERC721/IERC721.sol";

contract Marketplace {
}
```

`import`å…³é”®å­—ç”¨äºä»ä½œä¸ºä¾èµ–é¡¹å®‰è£…çš„ OpenZeppelin åˆåŒä¸­å¯¼å…¥`IERC721`æ™ºèƒ½åˆåŒã€‚IERC721 è¯»ä½œ ***æ¥å£â€”â€”ERC 721***ã€‚æ™ºèƒ½åˆçº¦çš„æ¥å£æä¾›äº†è¯¥æ™ºèƒ½åˆçº¦ä¸­å­˜åœ¨çš„æ‰€æœ‰å…¬å…±åŠŸèƒ½å’Œäº‹ä»¶çš„é«˜çº§æ¦‚è¿°ã€‚ä¸€ä¸ªæ¥å£åªåŒ…å«å‡½æ•°ç­¾åå’Œå‡½æ•°çš„äº‹ä»¶å£°æ˜ã€‚å®ƒå¸®åŠ©æˆ‘ä»¬çš„æ™ºèƒ½åˆçº¦è°ƒç”¨åŒºå—é“¾ä¸Šçš„å…¶ä»–æ™ºèƒ½åˆçº¦ã€‚æˆ‘ä»¬æ­£åœ¨å¯¼å…¥`IERC721`,å› ä¸ºå®ƒæ˜¯ ERC721 æ™ºèƒ½åˆçº¦çš„æ¥å£ï¼ŒERC 721 æ™ºèƒ½åˆçº¦æ˜¯åŒºå—é“¾ä¸Šè®¸å¤š NFT çš„åŸºç¡€ã€‚

## å®šä¹‰å…¨å±€å˜é‡

å¯¹æ™ºèƒ½åˆåŒè¿›è¡Œä»¥ä¸‹æ›´æ”¹:

```js
// SPDX-License-Identifier: Unlicensed

pragma solidity 0.8.4;

import "@openzeppelin/contracts/token/ERC721/IERC721.sol";

contract Marketplace {
    uint256 public itemCounter;
    address payable owner;
    uint256 public listingPrice;

    struct MarketItem {
        uint256 itemId;
        address nftContractAddress;
        uint256 tokenId;
        address payable seller;
        address payable owner;
        uint256 price;
        bool isSold;
        bool isPresent;
    }

    mapping(uint256 => MarketItem) private marketItems;

    event MarketItemListed(
        uint256 indexed itemId,
        address indexed nftContractAddress,
        uint256 indexed tokenId,
        address seller,
        address owner,
        uint256 price
    );

    constructor() {
  		itemCounter = 0;
  		owner = payable(msg.sender);
  		listingPrice = 0.01 ether;
		}
}
```

è¿™é‡Œæˆ‘ä»¬å®šä¹‰äº†ä»¥ä¸‹å†…å®¹:

*   itemCounter:ä¸€ä¸ªå…¬å…±å˜é‡ï¼Œç”¨äºå”¯ä¸€æ ‡è¯†æ™ºèƒ½åˆçº¦ä¸­åˆ—å‡ºçš„æ¯ä¸ª NFTã€‚

*   owner:è¯¥å˜é‡å­˜å‚¨æ™ºèƒ½åˆçº¦æ‰€æœ‰è€…çš„åœ°å€ã€‚æˆ‘ä»¬ä½¿ç”¨å…³é”®å­—`payable`è¡¨ç¤ºå­˜å‚¨åœ¨è¿™ä¸ªå˜é‡ä¸­çš„åœ°å€å¯ä»¥ç›´æ¥ä»æ™ºèƒ½å¥‘çº¦æ¥æ”¶ä»˜æ¬¾(åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯ MATIC)ã€‚è¿™æ˜¯å¿…è¦çš„ï¼Œå› ä¸ºæ™ºèƒ½åˆçº¦çš„æ‰€æœ‰è€…å°†ä»æ™ºèƒ½åˆçº¦ä¸­åˆ—å‡ºçš„æ‰€æœ‰éåŠŸèƒ½æ€§äº¤æ˜“ä¸­è·å¾—ä¸€å°ç¬”ä½£é‡‘ã€‚

*   listingPrice:è¯¥å˜é‡ç”¨äºå®šä¹‰ NFT ä¸Šå¸‚æ™ºèƒ½åˆçº¦æ‰€æœ‰è€…æ”¶å–çš„ä½£é‡‘é‡‘é¢ã€‚

*   MarketItem:æˆ‘ä»¬ä½¿ç”¨äº†å…³é”®å­—`struct`æ¥å®šä¹‰ä¸€ä¸ªå¤åˆæ•°æ®ç±»å‹ï¼Œç§°ä¸º*ç»“æ„ã€‚*ä¸€ä¸ªç»“æ„æ˜¯ä¸€ä¸ªç”±å¤šä¸ªä¸»è¦æ•°æ®ç±»å‹ç»„æˆçš„æ•°æ®ç±»å‹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒMarketItem æ˜¯ä¸€ä¸ªæ•°æ®ç±»å‹ï¼Œç”¨äºè¡¨ç¤ºåˆåŒä¸­åˆ—å‡ºçš„ NFTã€‚å®ƒç”±ä»¥ä¸‹ä¸»è¦æ•°æ®ç±»å‹ç»„æˆ:

    *   itemId:æ™ºèƒ½åˆçº¦ä¸­åˆ—å‡ºçš„æ¯ä¸ª NFT éƒ½è¢«åˆ†é…äº†ä¸€ä¸ªå”¯ä¸€çš„ itemIdã€‚
    *   nftContractAddress:è¯¥å˜é‡å­˜å‚¨åˆ—å‡ºçš„ NFT æ‰€å±çš„æ™ºèƒ½åˆçº¦çš„åˆçº¦åœ°å€ã€‚ç›¸åï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è¯´ï¼Œè¯¥å˜é‡ç”¨äºå­˜å‚¨æ™ºèƒ½åˆçº¦çš„åˆçº¦åœ°å€ï¼Œè¯¥æ™ºèƒ½åˆçº¦ç”¨äºé“¸é€ åˆ—å‡ºçš„ NFTã€‚
    *   tokenId:è¯¥å˜é‡å­˜å‚¨å¹³å°ä¸Šåˆ—å‡ºçš„ NFT çš„ tokenIdã€‚
    *   å–å®¶:è¿™æ˜¯å‡ºå”® NFT çš„è´¦æˆ·åœ°å€ã€‚è¯¥åœ°å€ä¹Ÿè¢«å®šä¹‰ä¸ºåº”ä»˜æ¬¾åœ°å€ï¼Œå› ä¸ºå–æ–¹å°†æ”¶åˆ°ä¹°æ–¹æ”¯ä»˜çš„é‡‘é¢ã€‚
    *   owner:ä¸€æ—¦ä»æˆ‘ä»¬çš„ Marketplace æ™ºèƒ½åˆçº¦ä¸­è´­ä¹°äº† NFTï¼Œæ­¤å˜é‡å°†å­˜å‚¨æ‹¥æœ‰è¯¥ NFT çš„å¸æˆ·ã€‚
    *   ä»·æ ¼:è¿™ä¸ªå­˜å‚¨äº† NFT çš„ä»·æ ¼ã€‚è¿™ä¸ªä»·æ ¼æ˜¯ç”±åˆŠç™»å‡ºå”® NFT çš„è´¦æˆ·è®¾å®šçš„ã€‚
    *   isSold:è¯¥å˜é‡å­˜å‚¨ NFT æ˜¯å¦å‡ºå”®ã€‚
    *   isPresent:å› ä¸ºæˆ‘ä»¬å°†ä½¿ç”¨æ˜ å°„å°† itemId æ˜ å°„åˆ°å•ç‹¬åˆ—å‡ºçš„ NFTï¼Œè¿™ä¸ªå˜é‡å°†æœ‰åŠ©äºæ£€æŸ¥ä¼ é€’çš„ itemId æ˜¯å¦æœ‰ NFTã€‚
*   marketItems:è¿™æ˜¯ä¸€ä¸ªç”¨äºå°†`uint256`æ•°æ®ç±»å‹æ˜ å°„åˆ°`MarketItem`æ•°æ®ç±»å‹çš„`mapping`ã€‚è¯¥å˜é‡ç”¨äºå­˜å‚¨åˆ—å‡ºçš„ NFT çš„ itemId ä¸å­˜å‚¨åœ¨ç»“æ„ MarketItem ä¸­çš„è¯¥ NFT çš„è¯¦ç»†ä¿¡æ¯ä¹‹é—´çš„æ˜ å°„ã€‚

*   event MarketItemListed:åœ¨æ™ºèƒ½åˆçº¦ä¸­ï¼Œæ— æ³•å‘æ§åˆ¶å°å†™å…¥/è¾“å‡ºå†…å®¹ï¼Œä¹Ÿæ— æ³•åœ¨æ—¥å¿—æ–‡ä»¶ä¸­è®°å½•æ•°æ®ã€‚å› æ­¤ï¼Œä¸ºäº†ç»´æŠ¤æ™ºèƒ½åˆçº¦æ‰§è¡Œçš„é‡è¦æ“ä½œçš„è®°å½•ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†`event`ã€‚

    ä¸€ä¸ªäº‹ä»¶å¯ä»¥æœ‰å„ç§å‚æ•°æ¥æä¾›å…³äºè¯¥äº‹ä»¶çš„é™„åŠ ç»†èŠ‚ã€‚`indexed`å…³é”®å­—ç”¨äºå¼•ç”¨äº‹ä»¶ä¸­çš„æŸä¸ªå‚æ•°ï¼Œå¯ä»¥ä½œä¸ºæŸ¥è¯¢å‚æ•°ã€‚

æœ€åï¼Œæˆ‘ä»¬åœ¨æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–ä»¥ä¸‹å˜é‡:

*   item counter:item counter å˜é‡è¢«åˆå§‹åŒ–ä¸º 0ã€‚
*   owner:é»˜è®¤æƒ…å†µä¸‹ï¼Œéƒ¨ç½²æ™ºèƒ½åˆçº¦çš„å¸æˆ·(éƒ¨ç½²å¸æˆ·çš„åœ°å€ç”±`msg.sender`å…³é”®å­—è¿”å›)è¢«è®¾ç½®ä¸ºæ™ºèƒ½åˆçº¦çš„æ‰€æœ‰è€…ã€‚æˆ‘ä»¬ä½¿ç”¨å…³é”®å­—`payable`èµ‹å€¼ï¼Œå°†`msg.sender`è¿”å›çš„åœ°å€ç±»å‹è½¬æ¢ä¸ºå¯ä»¥ä»æ™ºèƒ½åˆçº¦æ¥æ”¶ä»˜æ¬¾çš„åœ°å€ç±»å‹ã€‚
*   listingPrice:åœ¨æ™ºèƒ½åˆçº¦ä¸Šåˆ—å‡ºæ¯ä¸ª NFT éƒ½è¦æ”¶è´¹ã€‚æˆ‘ä»¬åœ¨`listingPrice`å˜é‡ä¸­æŒ‡å®šè¿™ä¸ªä»·æ ¼ã€‚é»˜è®¤å€¼è®¾ç½®ä¸º`0.01 ether`ï¼Œè¿™æ„å‘³ç€åˆ—å‡ºä¸€ä¸ª NFT éœ€è¦æ”¯ä»˜ 0.01 Maticã€‚`ether`æ˜¯åœ¨å®åº¦ä¸­å®šä¹‰çš„ä¸€ç§ç‰¹æ®Šç±»å‹çš„å•ä½ã€‚ä½ å¯ä»¥åœ¨å®˜æ–¹æ–‡ä»¶[è¿™é‡Œ](https://docs.soliditylang.org/en/v0.8.9/units-and-global-variables.html?highlight=ether#ether-units)é˜…è¯»æ›´å¤šå…³äºå•ä½`ether`çš„ä¿¡æ¯ã€‚

## åˆ›å»º listMarketItem å‡½æ•°

æ·»åŠ ä»¥ä¸‹åŠŸèƒ½:

```js
function listMarketItem(
    address nftContractAddress,
    uint256 tokenId,
    uint256 price
) public payable {
    require(msg.value == listingPrice, "Must pay the listing price");
    require(price > 0, "Price must be greater than 0");

    marketItems[itemCounter] = MarketItem(
        itemCounter,
        nftContractAddress,
        tokenId,
        payable(msg.sender),
        address(0),
        price,
        false,
        true
    );

    IERC721(nftContractAddress).transferFrom(
        msg.sender,
        address(this),
        tokenId
    );

    payable(owner).transfer(listingPrice);

    emit MarketItemListed(
        itemCounter,
        nftContractAddress,
        tokenId,
        msg.sender,
        address(0),
        price
    );

    itemCounter += 1;
}
```

ç°åœ¨è®©æˆ‘ä»¬ç†è§£ä»£ç :

*   è¯¥å‡½æ•°æ¥å— 3 ä¸ªå‚æ•°:`nftContractAddress`ã€`tokenId`å’Œ`price`ï¼Œåˆ†åˆ«ä»£è¡¨ NFT çš„åˆåŒåœ°å€ã€NFT çš„ tokenId å’Œå–å®¶å¸Œæœ›å‡ºå”®çš„ä»·æ ¼ã€‚è¿™æ˜¯ä¸€ä¸ªå…¬å…±å‡½æ•°ï¼Œæ„å‘³ç€ä»»ä½•äººéƒ½å¯ä»¥è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚ä½¿ç”¨ payable å…³é”®å­—æ˜¯å› ä¸ºä¸ºäº†ä½¿ç”¨è¯¥åŠŸèƒ½ï¼Œç”¨æˆ·å¿…é¡»æ”¯ä»˜ä¸Šå¸‚è´¹ç”¨ã€‚
*   `msg.value`è¿”å›è°ƒç”¨å‡½æ•°æ—¶å‘é€çš„ä»˜æ¬¾é‡‘é¢ã€‚å‘é€çš„é‡‘é¢å¿…é¡»ç­‰äºæ™ºèƒ½åˆçº¦æ‰€æœ‰è€…è®¾ç½®çš„åˆ—è¡¨ä»·æ ¼ã€‚`require(msg.value == listingPrice, "Must pay the listing price");`å¯¹æ­¤è¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœå‘é€çš„ä»¤ç‰Œæ•°é‡(åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯ MATIC)ä¸ç­‰äºæŒ‡å®šçš„åˆ—è¡¨ä»·æ ¼ï¼Œåˆ™è¿”å›ä¸€ä¸ªé”™è¯¯ã€‚
*   ä¸‹ä¸€ä¸ª require è¯­å¥ç¡®ä¿ä¸ºåˆåŒè®¾ç½®çš„é”€å”®ä»·æ ¼ä¸ä¸º 0ã€‚

```js
marketItems[itemCounter] = MarketItem(
    itemCounter,
    nftContractAddress,
    tokenId,
    payable(msg.sender),
    address(0),
    price,
    false,
    true
);
```

*   è¿™é‡Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç±»å‹ä¸º`MarketItem`çš„æ–°å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„`marketItems`æ˜ å°„å°†å®ƒæ˜ å°„åˆ°`itemCounter`çš„å€¼ã€‚`itemCounter`çš„ç°å€¼æˆä¸ºæˆ‘ä»¬ NFT çš„`itemId`ã€‚è°ƒç”¨æ­¤å‡½æ•°çš„è´¦æˆ·(ç”±`msg.sender`è¿”å›)è¢«è®¾ç½®ä¸º NFT çš„å–å®¶ã€‚æˆ‘ä»¬è®¾ç½®ä¸€ä¸ªç©ºåœ°å€(ç”¨`address(0)`è¡¨ç¤º)ä½œä¸º NFT çš„æ‰€æœ‰è€…ã€‚å½“æœ‰äººè´­ä¹° NFT æ—¶ï¼Œè¿™ç§æƒ…å†µå°†ä¼šæ”¹å˜ã€‚

```js
IERC721(nftContractAddress).transferFrom(
    msg.sender,
    address(this),
    tokenId
);
```

*   è¿™é‡Œï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨å¯¼å…¥çš„ IERC721 æ¥å£åˆ›å»ºä¸€ä¸ª ERC721 ç±»å‹çš„å¯¹è±¡ã€‚è¯¥æ¥å£éœ€è¦ ERC721 åˆåŒçš„åœ°å€ã€‚`IERC721(nftContractAddress)`è¿”å›å¯¹éƒ¨ç½²åœ¨`nftContractAddress`å˜é‡ä¸­å­˜å‚¨çš„åœ°å€çš„ ERC721 å¥‘çº¦çš„å¼•ç”¨ã€‚ERC721 å¥‘çº¦çš„`transferFrom`å‡½æ•°ç”¨äºå°† NFT ä»ç”¨æˆ·(`msg.sender`è¿”å›çš„åœ°å€)è½¬ç§»åˆ°æ™ºèƒ½å¥‘çº¦(`address(this)`è¿”å›çš„åœ°å€)ã€‚

    > æ³¨:ä¸ºäº†æˆ‘ä»¬çš„æ™ºèƒ½åˆçº¦èƒ½å¤Ÿå°† NFT ä»ç”¨æˆ·è½¬ç§»åˆ°è‡ªèº«ï¼Œç”¨æˆ·å¿…é¡»é¦–å…ˆæ‰¹å‡†æˆ‘ä»¬çš„æ™ºèƒ½åˆçº¦ä»£è¡¨ç”¨æˆ·èŠ±è´¹ NFTã€‚**

*   `payable(owner).transfer(listingPrice)`ç”¨äºå°† MATIC è½¬ç§»ç»™æ™ºèƒ½åˆçº¦çš„æ‰€æœ‰è€…ã€‚è¿™ä¸€è¡Œå°†ä¸ºä¸Šå¸‚æ”¯ä»˜çš„è´¹ç”¨è½¬ç§»ç»™æ‰€æœ‰è€…ã€‚

*   åœ¨è¿™ä¹‹åï¼Œ`emit`å…³é”®å­—è¢«ç”¨æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹ä»¶ç±»å‹ **MarketItemListed** ã€‚

*   æˆ‘ä»¬å°†`itemCounter`çš„å€¼å¢åŠ  1ï¼Œè¿™æ ·åˆ—å‡ºçš„ä¸‹ä¸€ä¸ª NFT å°†æœ‰ä¸€ä¸ªæ–°çš„`itemId`ã€‚

## åˆ›å»º buyMarketItem å‡½æ•°

æ·»åŠ ä»¥ä¸‹åŠŸèƒ½:

```js
function buyMarketItem(uint256 itemId) public payable {
    require(marketItems[itemId].isPresent, "Item is not present");
    require(marketItems[itemId].isSold == false, "Item is already sold");
    require(
        marketItems[itemId].price == msg.value,
        "Must pay the correct price"
    );

    marketItems[itemId].isSold = true;
    marketItems[itemId].owner = payable(msg.sender);

    IERC721(marketItems[itemId].nftContractAddress).transferFrom(
        address(this),
        msg.sender,
        marketItems[itemId].tokenId
    );
}
```

ç°åœ¨è®©æˆ‘ä»¬ç†è§£ä»£ç :

*   è¯¥å‡½æ•°åªæ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå³`itemId`ã€‚å®ƒçš„ç±»å‹æ˜¯ **public** å’Œ **payable** ï¼Œå› ä¸ºä»»ä½•äººéƒ½å¯ä»¥è°ƒç”¨è¿™ä¸ªå‡½æ•°æ¥è´­ä¹° NFTï¼Œè€Œä¸ºäº†è´­ä¹° NFTï¼Œåœ¨è°ƒç”¨è¿™ä¸ªå‡½æ•°æ—¶å¿…é¡»å‘é€ä»·æ ¼ã€‚
*   è¯¥å‡½æ•°æ£€æŸ¥ä»¥ä¸‹å†…å®¹:
    *   å­˜åœ¨ä¼ é€’äº† itemId çš„é¡¹ç›®ã€‚
    *   è¯¥ç‰©å“å°šæœªå”®å‡ºã€‚
    *   å‘é€çš„é‡‘é¢(ç”¨`msg.value`è¿”å›)ç­‰äºä¸º NFT æ”¯ä»˜çš„ä»·æ ¼ã€‚
*   æ­¤åï¼Œå•†å“è¢«æ ‡è®°ä¸ºå·²å”®ï¼ŒNFT çš„æ‰€æœ‰è€…ä»ç©ºç™½å˜ä¸ºè°ƒç”¨è¯¥å‡½æ•°çš„å¸æˆ·çš„åœ°å€ã€‚
*   æˆ‘ä»¬å†æ¬¡ä½¿ç”¨ IERC721 æ¥å£ä¸º ERC721 å¥‘çº¦åˆ›å»ºä¸€ä¸ªæ¥å£ï¼Œå¹¶å°† NFT ä»å¥‘çº¦æœ¬èº«(ç”±`address(this)`è¡¨ç¤º)è½¬ç§»åˆ°è°ƒç”¨è¯¥å‡½æ•°çš„å¸æˆ·(ç”±`msg.sender`è¡¨ç¤º)ã€‚

## åˆ›å»º getMarketItem å‡½æ•°

ç¼–å†™ä»¥ä¸‹å‡½æ•°:

```js
function getMarketItem(uint256 itemId)
    public
    view
    returns (MarketItem memory items)
{
    items = marketItems[itemId];
}
```

æ­¤å‡½æ•°ç”¨äºè¿”å›æ™ºèƒ½åˆåŒä¸­åˆ—å‡ºçš„é¡¹ç›®çš„è¯¦ç»†ä¿¡æ¯ã€‚æˆ‘ä»¬ä½¿ç”¨å…³é”®å­—`view`æ˜¯å› ä¸ºè¿™ä¸ªå‡½æ•°ä¸æ”¹å˜åŒºå—é“¾çš„çŠ¶æ€ï¼Œåªè¿”å›ä¸€ä¸ªå€¼ã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼Œåœ¨è°ƒç”¨è¿™ä¸ªåŠŸèƒ½çš„åŒæ—¶ï¼Œä¸éœ€è¦æ”¯ä»˜ä»»ä½•ç‡ƒæ°”è´¹ã€‚

è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°äº†å…³é”®å­—`returns`çš„æ–°è¯­æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ é€’è¦è¿”å›çš„å˜é‡åã€‚åœ¨ solidity 0.8.0 åŠæ›´é«˜ç‰ˆæœ¬ä¸­ï¼Œè¯¥è¯­æ³•å’Œä¼ ç»Ÿè¯­æ³•éƒ½æœ‰æ•ˆã€‚ä½¿ç”¨è¿™ç§è¯­æ³•çš„ä¸€ä¸ªä¸»è¦ä¼˜ç‚¹æ˜¯ï¼Œä¸éœ€è¦åœ¨å‡½æ•°æœ«å°¾è¿”å›å€¼ã€‚è¯¥å‡½æ•°è¿”å›å­˜å‚¨åœ¨`items`å˜é‡ä¸­çš„å€¼ã€‚åœ¨å‡½æ•°æ‰§è¡Œä¹‹åï¼Œå­˜å‚¨åœ¨`items`å˜é‡ä¸­çš„ä»»ä½•å€¼éƒ½å°†è¢«è¿”å›ã€‚

## åˆ›å»º changeListingPrice å‡½æ•°

æ·»åŠ ä»¥ä¸‹åŠŸèƒ½:

```js
function changeListingPrice(uint256 newPrice) public {
    require(newPrice > 0, "Listing Price must be greater than 0");
    require(
        msg.sender == owner,
        "Only the owner can change the listing price"
    );

    listingPrice = newPrice;
}
```

è¯¥å‡½æ•°å°†åªæ¥å—ä¸€ä¸ªå‚æ•°`newPrice`ï¼Œå®ƒè¡¨ç¤ºå°†æ”¶å–çš„æ–°çš„åˆ—è¡¨ä»·æ ¼ã€‚å¥‘çº¦é¦–å…ˆç¡®ä¿æ–°çš„æŒ‚ç‰Œä»·æ ¼å¤§äº 0ã€‚ç”±äºåªæœ‰åˆåŒçš„æ‰€æœ‰è€…å¯ä»¥ä¿®æ”¹æ ‡ä»·ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¿…é¡»æ£€æŸ¥è°ƒç”¨è¯¥å‡½æ•°çš„å¸æˆ·æ˜¯å¦æ˜¯æ‰€æœ‰è€…å¸æˆ·ã€‚æ£€æŸ¥é€šè¿‡åï¼Œ`listingPrice`å˜é‡è¢«æ›´æ–°ä»¥ä¿å­˜é€šè¿‡`newPrice`å‚æ•°ä¼ é€’çš„æ–°å€¼ã€‚

## æŠŠæ‰€æœ‰çš„æ”¾åœ¨ä¸€èµ·

æœ€ç»ˆçš„æ™ºèƒ½åˆåŒåº”è¯¥æ˜¯:

```js
// SPDX-License-Identifier: Unlicensed

pragma solidity 0.8.4;

import "@openzeppelin/contracts/token/ERC721/IERC721.sol";

contract Marketplace {
    uint256 public itemCounter;
    address payable owner;
    uint256 public listingPrice;

    struct MarketItem {
        uint256 itemId;
        address nftContractAddress;
        uint256 tokenId;
        address payable seller;
        address owner;
        uint256 price;
        bool isSold;
        bool isPresent;
    }

    mapping(uint256 => MarketItem) private marketItems;

    event MarketItemListed(
        uint256 indexed itemId,
        address indexed nftContractAddress,
        uint256 indexed tokenId,
        address seller,
        address owner,
        uint256 price
    );

    constructor() {
        itemCounter = 0;
        owner = payable(msg.sender);
        listingPrice = 0.01 ether;
    }

    function listMarketItem(
        address nftContractAddress,
        uint256 tokenId,
        uint256 price
    ) public payable {
        require(msg.value == listingPrice, "Must pay the listing price");
        require(price > 0, "Price must be greater than 0");

        marketItems[itemCounter] = MarketItem(
            itemCounter,
            nftContractAddress,
            tokenId,
            payable(msg.sender),
            address(0),
            price,
            false,
            true
        );

        IERC721(nftContractAddress).transferFrom(
            msg.sender,
            address(this),
            tokenId
        );

        payable(owner).transfer(listingPrice);

        emit MarketItemListed(
            itemCounter,
            nftContractAddress,
            tokenId,
            msg.sender,
            address(0),
            price
        );

        itemCounter += 1;
    }

    function buyMarketItem(uint256 itemId) public payable {
        require(marketItems[itemId].isPresent, "Item is not present");
        require(marketItems[itemId].isSold == false, "Item is already sold");
        require(
            marketItems[itemId].price == msg.value,
            "Must pay the correct price"
        );

        marketItems[itemId].isSold = true;
        marketItems[itemId].owner = payable(msg.sender);

        IERC721(marketItems[itemId].nftContractAddress).transferFrom(
            address(this),
            msg.sender,
            marketItems[itemId].tokenId
        );
    }

    function getMarketItem(uint256 itemId)
        public
        view
        returns (MarketItem memory items)
    {
        items = marketItems[itemId];
    }

    function changeListingPrice(uint256 newPrice) public {
        require(newPrice > 0, "Listing Price must be greater than 0");
        require(
            msg.sender == owner,
            "Only the owner can change the listing price"
        );

        listingPrice = newPrice;
    }
}
```

æ­å–œ<g-emoji class="g-emoji" alias="tada" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f389.png">ğŸ‰</g-emoji> <g-emoji class="g-emoji" alias="tada" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f389.png">ğŸ‰</g-emoji> <g-emoji class="g-emoji" alias="tada" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f389.png">ğŸ‰</g-emoji>ï¼æ‚¨çš„æ™ºèƒ½åˆçº¦å·²å‡†å¤‡å¥½æ¥å—æµ‹è¯•ã€‚

# æµ‹è¯•æˆ‘ä»¬çš„æ™ºèƒ½åˆçº¦

æ—¢ç„¶æˆ‘ä»¬çš„æ™ºèƒ½åˆåŒå·²ç»å®Œæˆï¼Œæµ‹è¯•å®ƒçš„åŠŸèƒ½ä»¥é¿å…ä»»ä½•æ˜æ˜¾çš„é”™è¯¯è¿›å…¥ç”Ÿäº§ç¯å¢ƒæ˜¯å¾ˆé‡è¦çš„ã€‚æˆ‘ä»¬å°†é’ˆå¯¹ä»¥ä¸‹å†…å®¹æµ‹è¯•æˆ‘ä»¬çš„æ™ºèƒ½åˆçº¦:

*   NFT ä¸Šå¸‚:
    *   NFT æˆåŠŸä¸Šå¸‚
    *   å¦‚æœä¸æ”¯ä»˜ä¸Šå¸‚ä»·æ ¼ï¼ŒNFT å°±ä¸èƒ½ä¸Šå¸‚
    *   å¦‚æœ NFT æœªç»ç”¨æˆ·æ‰¹å‡†ï¼Œåˆ™ NFT ä¸èƒ½ä¸Šå¸‚
*   è´­ä¹° NFT:
    *   è´­ä¹° NFT
    *   NFT æ˜¯ä¸èƒ½ç”¨æ›´ä½çš„ä»·æ ¼ä¹°åˆ°çš„
    *   NFT ä¹°ä¸äº†ä¸¤æ¬¡

## æµ‹è¯•è®¾ç½®

å°½ç®¡æˆ‘ä»¬å·²ç»å®‰è£…äº†ç¼–å†™æµ‹è¯•ç”¨ä¾‹æ‰€éœ€çš„èŠ‚ç‚¹åŒ…ï¼Œä½†æ˜¯ç¼–å†™æµ‹è¯•ç”¨ä¾‹è¿˜æœ‰æœ€åä¸€ä¸ªå…ˆå†³æ¡ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ª ERC721 å¥‘çº¦ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒåœ¨æµ‹è¯•æ—¶åˆ›å»º NFTã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†å¤åˆ¶æˆ‘ä»¬åœ¨[ä½¿ç”¨å®‰å…¨å¸½åˆ›å»º NFT æ™ºèƒ½åˆåŒ](https://learn.figment.io/tutorials/create-nft-smart-contract-with-hardhat#testing-the-smart-contract)æ•™ç¨‹ä¸­å¼€å‘çš„åˆåŒã€‚

åœ¨`contracts`ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåä¸º`Artwork.sol`çš„æ–°æ–‡ä»¶ï¼Œå¹¶ç²˜è´´ä»¥ä¸‹ä»£ç :

```js
//SPDX-License-Identifier: Unlicense
pragma solidity 0.8.4;

import "@openzeppelin/contracts/token/ERC721/ERC721.sol";

contract Artwork is ERC721 {
    uint256 public tokenCounter;
    mapping(uint256 => string) private _tokenURIs;

    constructor(string memory name, string memory symbol) ERC721(name, symbol) {
        tokenCounter = 0;
    }

    function mint(string memory _tokenURI) public {
        _safeMint(msg.sender, tokenCounter);
        _setTokenURI(tokenCounter, _tokenURI);

        tokenCounter++;
    }

    function _setTokenURI(uint256 _tokenId, string memory _tokenURI)
        internal
        virtual
    {
        require(
            _exists(_tokenId),
            "ERC721Metadata: URI set of nonexistent token"
        ); // Checks if the tokenId exists
        _tokenURIs[_tokenId] = _tokenURI;
    }

    function tokenURI(uint256 _tokenId)
        public
        view
        virtual
        override
        returns (string memory)
    {
        require(
            _exists(_tokenId),
            "ERC721Metadata: URI set of nonexistent token"
        );
        return _tokenURIs[_tokenId];
    }
}
```

ç°åœ¨åœ¨`test`ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º`market-test.js`çš„æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶å°†åŒ…å«æˆ‘ä»¬æ‰€æœ‰çš„å•å…ƒæµ‹è¯•ã€‚ä½¿ç”¨ä»¥ä¸‹ä»£ç å¯¼å…¥æ‰€éœ€çš„æµ‹è¯•åº“:

```js
const { expect } = require("chai");
const { ethers } = require("hardhat");
```

## å†™ä½œæµ‹è¯•

ç°åœ¨æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½ç¼–å†™æµ‹è¯•ç”¨ä¾‹äº†ã€‚è®©æˆ‘ä»¬ä»ä»¥ä¸‹å†…å®¹å¼€å§‹:

```js
describe("Listing of NFT", function () {
  this.beforeEach(async function () {
    const Artwork = await ethers.getContractFactory("Artwork");
    const Marketplace = await ethers.getContractFactory("Marketplace");

    nftContract1 = await Artwork.deploy("Artwork Contract", "ART");
    marketplace = await Marketplace.deploy();

    [account1] = await ethers.getSigners();
    const tokenURI1 =
      "https://opensea-creatures-api.herokuapp.com/api/creature/1";
    const tokenURI2 =
      "https://opensea-creatures-api.herokuapp.com/api/creature/2";

    await nftContract1.connect(account1).mint(tokenURI1);
    await nftContract1.connect(account1).mint(tokenURI2);

    // Approving marketplace to spend NFTs
    await nftContract1.connect(account1).approve(marketplace.address, 0);
  });

  it("NFT is successfully listed", async function () {
    // Listing NFT
    await marketplace
      .connect(account1)
      .listMarketItem(nftContract1.address, 0, ethers.utils.parseEther("0.1"), {
        value: ethers.utils.parseEther("0.01"),
      });

    // Checking if NFT is listed
    const listedNFT = await marketplace.getMarketItem(0);
    expect(listedNFT.nftContractAddress).to.equal(nftContract1.address);
    expect(listedNFT.price).to.equal(ethers.utils.parseEther("0.1"));
  });

  it("NFT can't be listed if listingPrice is not paid", async function () {
    await expect(
      marketplace
        .connect(account1)
        .listMarketItem(
          nftContract1.address,
          0,
          ethers.utils.parseEther("0.1"),
          { value: ethers.utils.parseEther("0") }
        )
    ).to.be.revertedWith("Must pay the listing price");
  });

  it("NFT can't be listed if NFT is not approved by user", async function () {
    await expect(
      marketplace
        .connect(account1)
        .listMarketItem(
          nftContract1.address,
          1,
          ethers.utils.parseEther("0.1"),
          {
            value: ethers.utils.parseEther("0.01"),
          }
        )
    ).to.revertedWith("ERC721: transfer caller is not owner nor approved");
  });
});
```

è¿™é‡Œæˆ‘ä»¬æ­£åœ¨å¤„ç†ç¬¬ä¸€ç§ç±»å‹çš„æµ‹è¯•ç”¨ä¾‹ã€‚

*   `this.beforeEach()`ç”¨äºå®šä¹‰å°†åœ¨æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ä¹‹å‰æ‰§è¡Œçš„ä»£ç ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬

    *   é¦–å…ˆéƒ¨ç½²ç”¨äºåˆ›å»º NFTs å’Œå¸‚åœºæ™ºèƒ½åˆçº¦çš„ ERC721 æ™ºèƒ½åˆçº¦ã€‚
    *   ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ ERC721 åˆåŒåˆ¶é€ ä¸¤ä¸ªæ–°çš„ NFTã€‚
    *   æˆ‘ä»¬æ‰¹å‡† marketplace åˆåŒï¼Œä»£è¡¨æ‹¥æœ‰ NFT çš„å¸æˆ·ä½¿ç”¨ç¬¬ä¸€ä¸ª NFT(ç”¨ tokenId 0 è¡¨ç¤º),è€Œä¸æ‰¹å‡†ç¬¬äºŒä¸ªã€‚
*   `it`ç”¨äºå®šä¹‰æ¯ä¸ªå•å…ƒæµ‹è¯•ã€‚æˆ‘ä»¬ä½¿ç”¨å®šä¹‰çš„`listMarketItem`æ¥åˆ—å‡ºæˆ‘ä»¬çš„ NFTã€‚ä½¿ç”¨`value`å‚æ•°å®šä¹‰è¦å‘é€çš„ä»¥å¤ªç½‘æ•°é‡ã€‚`ethers.utils.parseEther()`ç”¨äºå°†ä¼ é€’çš„å€¼è½¬æ¢æˆå¯ä»¥ä¼ é€’ç»™æ™ºèƒ½åˆçº¦çš„ç­‰ä»·æ•´æ•°ã€‚è¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬ä¼ é€’ 1ï¼Œå®ƒå°†ä»£è¡¨ 1 MATIC æˆ– 1 * 10^18.è´­ä¹°ä¸Šå¸‚ NFT çš„ä»·æ ¼å®šä¸º *0.1 MATIC* ã€‚

    ç„¶åæˆ‘ä»¬ä½¿ç”¨`getMarketItem()`å‡½æ•°ã€‚å› ä¸ºè¿™æ˜¯åˆåŒä¸­åˆ—å‡ºçš„ç¬¬ä¸€ä¸ªé¡¹ç›®ï¼Œæ‰€ä»¥ itemId å°†ä¸º 0ã€‚æˆ‘ä»¬ç¡®ä¿ NFT çš„åˆåŒåœ°å€ä¸æˆ‘ä»¬ç”¨æ¥é“¸é€ å®ƒçš„ ERC721 åˆåŒåœ°å€ç›¸åŒ¹é…ã€‚æˆ‘ä»¬è¿˜æ£€æŸ¥ä»·æ ¼è®¾ç½®æ˜¯å¦æ­£ç¡®ã€‚

*   åœ¨ä¸‹ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ä¸­ï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨å‡½æ•°æ—¶ä¼ é€’ 0 MATICã€‚è¿™å°†è¿”å›é”™è¯¯æ¶ˆæ¯â€œå¿…é¡»æ”¯ä»˜æ ‡ä»·â€ï¼Œä½¿ç”¨`to.be.revertedWith()`å‡½æ•°è¿›è¡Œæ£€æŸ¥ã€‚è¯¥å‡½æ•°æ£€æŸ¥è¿”å›çš„é”™è¯¯ä¿¡æ¯ã€‚

*   åœ¨ç¬¬ä¸‰ä¸ªæµ‹è¯•æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬è¯•å›¾åˆ—å‡ºç¬¬äºŒä¸ªæ²¡æœ‰è¢«æ‰¹å‡†çš„ NFTã€‚å½“æˆ‘ä»¬çš„æ™ºèƒ½åˆçº¦è¯•å›¾å°† NFT ä»æ‰€æœ‰è€…è½¬ç§»åˆ°è‡ªèº«æ—¶ï¼Œè¿™å°†äº§ç”Ÿä¸€ä¸ªé”™è¯¯ã€‚é”™è¯¯ä¿¡æ¯å°†ä¸º`ERC721: transfer caller is not owner nor approved`ã€‚æˆ‘ä»¬å†æ¬¡ä½¿ç”¨`to.be.revertedWith()`å‡½æ•°æ¥æ£€æŸ¥è¿™ä¸ªé”™è¯¯æ¶ˆæ¯ã€‚

ä¸ºäº†è¿è¡Œæµ‹è¯•ç”¨ä¾‹ï¼Œåœ¨æ§åˆ¶å°ä¸­é”®å…¥ä»¥ä¸‹å‘½ä»¤:

```js
npx hardhat test 
```

è¾“å‡ºåº”è¯¥æ˜¯è¿™æ ·çš„

[![First Teest](img/99c52f46c6cd2b9ae6e293ce41ad7cb7.png)](https://github.com/figment-networks/learn-tutorials/raw/master/assets/testingCont1.png)

ç°åœ¨è®©æˆ‘ä»¬ç¼–å†™ç¬¬äºŒç»„æµ‹è¯•ç”¨ä¾‹:

```js
describe("Buying of NFT", function () {
  this.beforeEach(async function () {
    const Artwork = await ethers.getContractFactory("Artwork");
    const Marketplace = await ethers.getContractFactory("Marketplace");

    nftContract1 = await Artwork.deploy("Artwork Contract", "ART");
    marketplace = await Marketplace.deploy();

    [account1, account2] = await ethers.getSigners();
    const tokenURI =
      "https://opensea-creatures-api.herokuapp.com/api/creature/1";

    await nftContract1.connect(account1).mint(tokenURI);
    await nftContract1.connect(account1).approve(marketplace.address, 0);
    await marketplace
      .connect(account1)
      .listMarketItem(nftContract1.address, 0, ethers.utils.parseEther("0.1"), {
        value: ethers.utils.parseEther("0.01"),
      });
  });

  it("Buying NFT", async function () {
    prevBalance = await nftContract1.balanceOf(account2.address);
    await marketplace
      .connect(account2)
      .buyMarketItem(0, { value: ethers.utils.parseEther("0.1") });
    presentBalance = await nftContract1.balanceOf(account2.address);

    expect(prevBalance).to.equal(0);
    expect(presentBalance).to.equal(1);
  });

  it("NFT can't be bought by paying a lower price", async function () {
    await expect(
      marketplace
        .connect(account2)
        .buyMarketItem(0, { value: ethers.utils.parseEther("0.01") })
    ).to.be.revertedWith("Must pay the correct price");
  });

  it("NFT can't be bought twice", async function () {
    await marketplace
      .connect(account2)
      .buyMarketItem(0, { value: ethers.utils.parseEther("0.1") });
    await expect(
      marketplace
        .connect(account2)
        .buyMarketItem(0, { value: ethers.utils.parseEther("0.1") })
    ).to.be.revertedWith("Item is already sold");
  });
});
```

*   åœ¨è¿è¡Œæµ‹è¯•ç”¨ä¾‹ä¹‹å‰ï¼Œæˆ‘ä»¬ç¡®ä¿éƒ¨ç½²äº† ERC721 å’Œæˆ‘ä»¬çš„ Marketplace åˆåŒï¼Œå¹¶ä¸”åœ¨æˆ‘ä»¬çš„åˆåŒä¸­åˆ—å‡ºäº† NFTã€‚NFT ä»¥ 0.1 MATIC çš„å”®ä»·ä¸Šå¸‚ã€‚
*   ä¸ºäº†æ£€æŸ¥`buyMarketItem()`å‡½æ•°æ˜¯å¦æ­£å¸¸å·¥ä½œï¼Œæˆ‘ä»¬é¦–å…ˆè¿æ¥ä¸€ä¸ªæ–°å¸æˆ·(è¿™é‡Œæ˜¯`account2`)å¹¶è°ƒç”¨è¯¥å‡½æ•°ï¼Œå°† itemId (itemId å°†æ˜¯åˆåŒä¸­åˆ—å‡ºçš„ç¬¬ä¸€ä¸ªå•†å“çš„`0`)ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œç„¶åä½¿ç”¨`value`å‚æ•°å‘é€ NFT çš„ä»·æ ¼ã€‚æˆ‘ä»¬ä½¿ç”¨ ERC721 æ™ºèƒ½åˆçº¦ä¸­çš„`balanceOf`å‡½æ•°ï¼Œåœ¨äº¤æ˜“å‰åæ‰¾åˆ°è´¦æˆ·ä½™é¢ã€‚è´­ä¹°å‰çš„ä½™é¢åº”è¯¥æ˜¯ 0ï¼Œäº¤æ˜“ååº”è¯¥æ˜¯ 1ã€‚è¿™å°†è¯æ˜ NFT æ˜¯æˆåŠŸè´­ä¹°çš„ã€‚
*   ä¸ºäº†æ£€æŸ¥æ˜¯å¦æœ‰å¯èƒ½ä»¥æ¯”åˆ—å‡ºçš„ä»·æ ¼æ›´ä½çš„ä»·æ ¼è´­ä¹° NFTï¼Œæˆ‘ä»¬å°è¯•åœ¨`value`å‚æ•°ä¸­ä¼ é€’ä¸€ä¸ªæ›´ä½çš„å€¼ã€‚è¿™åº”è¯¥ä¼šè¿”å›æˆ‘ä»¬å®šä¹‰çš„é”™è¯¯æ¶ˆæ¯ï¼Œå³â€œå¿…é¡»ä»˜å‡ºæ­£ç¡®çš„ä»£ä»·â€ã€‚
*   ä¸ºäº†æ£€æŸ¥æ˜¯å¦å¯èƒ½ä¸¤æ¬¡è´­ä¹°ç›¸åŒçš„ NFTï¼Œæˆ‘ä»¬å°è¯•ç”¨ç›¸åŒçš„`itemId`è°ƒç”¨`buyMarketItem()`ä¸¤æ¬¡ã€‚ç¬¬ä¸€æ¬¡ï¼Œå®ƒå°†æŒ‰é¢„æœŸå·¥ä½œï¼Œå¹¶å°† NFT è½¬ç§»åˆ°è´­ä¹° NFT çš„å¸æˆ·ï¼Œä½†æ˜¯ç¬¬äºŒæ¬¡ï¼Œå®ƒå°†è¿”å›ä¸€ä¸ªé”™è¯¯æ¶ˆæ¯â€œé¡¹ç›®å·²ç»å”®å‡ºâ€ï¼Œè¿™è¡¨æ˜å®ƒæ˜¯ä¸å¯èƒ½è´­ä¹° NFT ä¸€æ—¦å·²ç»å”®å‡ºã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œæµ‹è¯•æ–‡ä»¶çš„æœ€ç»ˆå†…å®¹å°†æ˜¯:

```js
const { expect } = require("chai");
const { ethers } = require("hardhat");

describe("Listing of NFT", function () {
  this.beforeEach(async function () {
    const Artwork = await ethers.getContractFactory("Artwork");
    const Marketplace = await ethers.getContractFactory("Marketplace");

    nftContract1 = await Artwork.deploy("Artwork Contract", "ART");
    marketplace = await Marketplace.deploy();

    [account1] = await ethers.getSigners();
    const tokenURI1 =
      "https://opensea-creatures-api.herokuapp.com/api/creature/1";
    const tokenURI2 =
      "https://opensea-creatures-api.herokuapp.com/api/creature/2";

    await nftContract1.connect(account1).mint(tokenURI1);
    await nftContract1.connect(account1).mint(tokenURI2);

    // Approving marketplace to spend NFTs
    await nftContract1.connect(account1).approve(marketplace.address, 0);
  });

  it("NFT is successfully listed", async function () {
    // Listing NFT
    await marketplace
      .connect(account1)
      .listMarketItem(nftContract1.address, 0, ethers.utils.parseEther("0.1"), {
        value: ethers.utils.parseEther("0.01"),
      });

    // Checking if NFT is listed
    const listedNFT = await marketplace.getMarketItem(0);
    expect(listedNFT.nftContractAddress).to.equal(nftContract1.address);
    expect(listedNFT.price).to.equal(ethers.utils.parseEther("0.1"));
  });

  it("NFT can't be listed if listingPrice is not paid", async function () {
    await expect(
      marketplace
        .connect(account1)
        .listMarketItem(
          nftContract1.address,
          0,
          ethers.utils.parseEther("0.1"),
          { value: ethers.utils.parseEther("0") }
        )
    ).to.be.revertedWith("Must pay the listing price");
  });

  it("NFT can't be listed if NFT is not approved by user", async function () {
    await expect(
      marketplace
        .connect(account1)
        .listMarketItem(
          nftContract1.address,
          1,
          ethers.utils.parseEther("0.1"),
          {
            value: ethers.utils.parseEther("0.01"),
          }
        )
    ).to.revertedWith("ERC721: transfer caller is not owner nor approved");
  });
});

describe("Buying of NFT", function () {
  this.beforeEach(async function () {
    const Artwork = await ethers.getContractFactory("Artwork");
    const Marketplace = await ethers.getContractFactory("Marketplace");

    nftContract1 = await Artwork.deploy("Artwork Contract", "ART");
    marketplace = await Marketplace.deploy();

    [account1, account2] = await ethers.getSigners();
    const tokenURI =
      "https://opensea-creatures-api.herokuapp.com/api/creature/1";

    await nftContract1.connect(account1).mint(tokenURI);
    await nftContract1.connect(account1).approve(marketplace.address, 0);
    await marketplace
      .connect(account1)
      .listMarketItem(nftContract1.address, 0, ethers.utils.parseEther("0.1"), {
        value: ethers.utils.parseEther("0.01"),
      });
  });

  it("Buying NFT", async function () {
    prevBalance = await nftContract1.balanceOf(account2.address);
    await marketplace
      .connect(account2)
      .buyMarketItem(0, { value: ethers.utils.parseEther("0.1") });
    presentBalance = await nftContract1.balanceOf(account2.address);

    expect(prevBalance).to.equal(0);
    expect(presentBalance).to.equal(1);
  });

  it("NFT can't be bought by paying a lower price", async function () {
    await expect(
      marketplace
        .connect(account2)
        .buyMarketItem(0, { value: ethers.utils.parseEther("0.01") })
    ).to.be.revertedWith("Must pay the correct price");
  });

  it("NFT can't be bought twice", async function () {
    await marketplace
      .connect(account2)
      .buyMarketItem(0, { value: ethers.utils.parseEther("0.1") });
    await expect(
      marketplace
        .connect(account2)
        .buyMarketItem(0, { value: ethers.utils.parseEther("0.1") })
    ).to.be.revertedWith("Item is already sold");
  });
});
```

æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨æ§åˆ¶å°ä¸­é”®å…¥ä»¥ä¸‹å‘½ä»¤æ¥è¿è¡Œæµ‹è¯•:

```js
npx hardhat test
```

é¢„æœŸçš„è¾“å‡ºå°†æ˜¯:

[![Second Test](img/af9536188a731dc6f74950baf5875d81.png)](https://github.com/figment-networks/learn-tutorials/raw/master/assets/testingCont2.png)

# Console.log() in solidity

hardhat å±•ç¤ºçš„ä¸€ä¸ªå¾ˆé…·çš„åŠŸèƒ½æ˜¯èƒ½å¤Ÿå°†æ•°æ®è®°å½•åˆ°æ§åˆ¶å°ä¸Šã€‚HardHat ä½¿å¾—åœ¨æˆ‘ä»¬çš„æ™ºèƒ½å¥‘çº¦ä¸­ä½¿ç”¨`console.log()`è¯­å¥æˆä¸ºå¯èƒ½ã€‚è¿™ä½¿å¾—å°†ä»»ä½•ä¸œè¥¿æ‰“å°åˆ°æ§åˆ¶å°/ç»ˆç«¯æˆä¸ºå¯èƒ½ï¼Œè¿™åœ¨æµ‹è¯•å’Œè°ƒè¯•æœŸé—´éå¸¸æ–¹ä¾¿ã€‚è®©æˆ‘ä»¬å¿«é€Ÿäº†è§£ä¸€ä¸‹ã€‚

æˆ‘ä»¬ä»ä½¿ç”¨`import`å…³é”®å­—å¯¼å…¥`console.sol`åº“å¼€å§‹ã€‚

```js
import "hardhat/console.sol";
```

æˆ‘ä»¬å°†ä½¿ç”¨`console.log()`å‡½æ•°æ¥æ‰“å°è´¦æˆ·è´­ä¹° NFT æ—¶çš„è¯¦ç»†ä¿¡æ¯ã€‚åœ¨`buyMarketItem()`åŠŸèƒ½ä¸­è¿›è¡Œä»¥ä¸‹æ›´æ”¹:

```js
function buyMarketItem(uint256 itemId) public payable {
	  // Code has been removed for display purposes
    console.log("NFT with itemId ", itemId, "is sold to ", msg.sender);
}
```

ç°åœ¨è®©æˆ‘ä»¬ç”¨`npx hardhat test`å‘½ä»¤å†æ¬¡è¿è¡Œæµ‹è¯•ã€‚è¾“å‡ºå°†æ˜¯:

[![Third Test](img/09fdc8b56ea6e1e5ef5a6c94676c9750.png)](https://github.com/figment-networks/learn-tutorials/raw/master/assets/testingCont3.png)

åœ¨æˆ‘ä»¬è¿è¡Œæµ‹è¯•æ—¶,`console.log()`è¯­å¥æ‰“å°è¯¥å€¼ã€‚

è¯·æ³¨æ„ï¼Œå½“åˆåŒéƒ¨ç½²åˆ°ä»»ä½•åŒºå—é“¾æ—¶ï¼Œ`console.log()`å£°æ˜æ²¡æœ‰ç”¨ï¼Œä»…ç”¨äºæµ‹è¯•ã€‚å› æ­¤ï¼Œåœ¨æˆ‘ä»¬ç€æ‰‹éƒ¨ç½²åˆåŒä¹‹å‰ï¼Œç§»é™¤è¿™æ¡çº¿æ˜¯å¾ˆé‡è¦çš„ï¼Œå¦åˆ™å®ƒå°†æ¶ˆè€—æ›´å¤šçš„å¤©ç„¶æ°”ã€‚

# éƒ¨ç½²åˆåŒ

åœ¨æˆ‘ä»¬å°†æ™ºèƒ½åˆçº¦éƒ¨ç½²åˆ° Polygon Mumbai testnet ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ä¸€äº›ç¯å¢ƒå˜é‡ã€‚åœ¨æˆ‘ä»¬é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º`.env`çš„æ–°æ–‡ä»¶ï¼Œå¹¶å­˜å‚¨ Polygonscan çš„ API å¯†é’¥å’Œæ‚¨æƒ³è¦ç”¨æ¥éƒ¨ç½²æ™ºèƒ½å¥‘çº¦çš„å¸æˆ·çš„ç§é’¥ã€‚

```js
POLYGONSCAN_KEY=Paste the API key here
PRIVATE_KEY=Paste the private key here 
```

ç°åœ¨ä¿®æ”¹`harhat.config.js`çš„å†…å®¹å¦‚ä¸‹:

```js
require("@nomiclabs/hardhat-waffle");
require("@nomiclabs/hardhat-etherscan")
require("dotenv").config();

task("deploy", "Deploy the smart contracts", async(taskArgs, hre) => {

  const Marketplace = await hre.ethers.getContractFactory("Marketplace");
  const marketplace = await Marketplace.deploy();

  await marketplace.deployed();

  await hre.run("verify:verify", {
    address: marketplace.address,
    constructorArguments: []
  })

})

/**
 * @type import('hardhat/config').HardhatUserConfig
 */
module.exports = {
  solidity: "0.8.4",
  networks: {
    mumbai: {
      url: "https://matic-testnet-archive-rpc.bwarelabs.com",
      accounts: [
        process.env.PRIVATE_KEY
      ]
    }
  },
  etherscan: {
    apiKey: process.env.POLYGONSCAN_KEY
  }
};
```

ä½ å¯ä»¥å‚è€ƒ[è¿™é‡Œçš„](https://learn.figment.io/tutorials/create-nft-smart-contract-with-hardhat#modifying-the-config-file)æ¥æ›´è¯¦ç»†çš„äº†è§£è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚éœ€è¦æ³¨æ„çš„è¦ç‚¹æ˜¯:

*   åšå›ºçš„ç‰ˆæœ¬ã€‚æˆ‘ä»¬å·²ç»ä½¿ç”¨ç‰ˆæœ¬`0.8.4`æ¥ç¼–å†™æˆ‘ä»¬çš„æ™ºèƒ½åˆåŒï¼Œå› æ­¤è¿™é‡ŒæŒ‡å®šçš„ç‰ˆæœ¬åº”è¯¥ä¸ç”¨äºç¼–å†™åˆåŒçš„ç‰ˆæœ¬ç›¸åŒ¹é…ã€‚
*   åœ¨`networks`éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰æƒ³è¦éƒ¨ç½²çš„å„ç§ç½‘ç»œã€‚
*   åœ¨`etherscan`éƒ¨åˆ†ï¼Œæˆ‘ä»¬å®šä¹‰äº† Polygonscan éœ€è¦çš„`apiKey`,ä»¥ä¾¿éªŒè¯æˆ‘ä»¬çš„æ™ºèƒ½å¥‘çº¦å¹¶åœ¨ blockexplorer ä¸­æ˜¾ç¤ºå…¶ä»£ç ã€‚
*   æˆ‘ä»¬è¿˜å®šä¹‰äº†ä¸€ä¸ªåä¸º`deploy`çš„ä»»åŠ¡ï¼Œå®ƒå°†ä½¿æˆ‘ä»¬èƒ½å¤Ÿéƒ¨ç½²æˆ‘ä»¬çš„æ™ºèƒ½åˆçº¦ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªå‘½ä»¤å¯¹å…¶è¿›è¡ŒéªŒè¯ã€‚

è¦éƒ¨ç½²æ™ºèƒ½åˆçº¦ï¼Œè¯·é”®å…¥ä»¥ä¸‹å‘½ä»¤:

```js
npx hardhat deploy --network mumbai 
```

è¾“å‡ºå¦‚ä¸‹æ‰€ç¤º:

[![Deploying and Verifying](img/7e923fa499af5e1b60dc303e4e46cb59.png)](https://github.com/figment-networks/learn-tutorials/raw/master/assets/deployingandverifying.png)

åœ¨æ‚¨çš„æƒ…å†µä¸‹ï¼ŒåˆåŒåœ°å€ä¼šæœ‰æ‰€ä¸åŒã€‚ä½ å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹æˆ‘éƒ¨ç½²çš„ã€‚

## ä¸æ™ºèƒ½åˆåŒäº¤äº’

æˆ‘ä»¬ç°åœ¨å°†ä¸æˆ‘ä»¬çš„æ™ºèƒ½åˆçº¦è¿›è¡Œäº¤äº’ï¼Œå¹¶åœ¨æˆ‘ä»¬çš„å¸‚åœºæ™ºèƒ½åˆçº¦ä¸­åˆ—å‡ºä¸Šä¸€æ•™ç¨‹ä¸­åˆ›å»ºçš„ NFTã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»æ‰¹å‡† MarketPlace smart åˆåŒï¼Œä»¥ä½¿ç”¨æˆ‘ä»¬çš„ NFTã€‚ä¸ºæ­¤:

1.  å¤åˆ¶æˆ‘ä»¬åˆšåˆšéƒ¨ç½²çš„å¸‚åœºæ™ºèƒ½åˆåŒçš„åˆåŒåœ°å€ã€‚
2.  å» Polygonscan æ‰“å¼€ç”¨äºåˆ›å»º NFT çš„åˆåŒã€‚
3.  åœ¨`Contract`éƒ¨åˆ†ï¼Œè½¬åˆ°`Write Contract`é€‰é¡¹å¡å¹¶è¿æ¥æ‚¨çš„ Metamask é’±åŒ…ã€‚ä»”ç»†æ£€æŸ¥æ‚¨æ˜¯å¦è¿æ¥åˆ° Mumbai testnetï¼Œå¹¶é€‰æ‹©äº†ç”¨äºåœ¨ Metamask ä¸­åˆ›å»º NFT çš„ç›¸åŒå¸æˆ·ã€‚
4.  ç°åœ¨ï¼Œåœ¨`approve`å‡½æ•°ä¸­ï¼Œå°† NFT çš„å¸‚åœºåˆåŒåœ°å€å’Œä»¤ç‰Œ Id åˆ†åˆ«ç²˜è´´åˆ°`to`å’Œ`tokenId`å­—æ®µä¸­ï¼Œå¹¶å•å‡»å†™å…¥æŒ‰é’®ã€‚
5.  ç­¾ç½²äº¤æ˜“å¹¶ç­‰å¾…äº¤æ˜“å¾—åˆ°éªŒè¯ã€‚

ç°åœ¨æˆ‘ä»¬åœ¨ Polygonscan ä¸­æ‰“å¼€å¸‚åœºåˆåŒ:

1.  åœ¨`Contract`éƒ¨åˆ†ï¼Œè½¬åˆ°`Write Contract`é€‰é¡¹å¡å¹¶è¿æ¥æ‚¨çš„ Metamask é’±åŒ…ã€‚
2.  åœ¨`listMarketItem`åŠŸèƒ½ä¸­å¡«å†™è¦åˆ—å‡ºçš„ NFT çš„è¯¦ç»†ä¿¡æ¯ã€‚
    *   ç¬¬ä¸€ä¸ªå­—æ®µæ˜¯åˆŠç™»ç‰©å“çš„è´¹ç”¨ã€‚æˆ‘ä»¬å·²ç»å°†å®ƒè®¾ç½®ä¸º`0.01 MATIC`
    *   `nftContractAddress`å’Œ`tokenId`å°†å–å†³äºä½ ä¸Šå¸‚çš„ NFTã€‚
    *   ä½ ä¹Ÿå¯ä»¥æŠŠä½ å–œæ¬¢çš„ä»»ä½•ä»·æ ¼ã€‚è¿™å°†æ˜¯æœ‰äººä»ä½ è¿™é‡Œä¹°ä¸‹ NFT çš„ä»£ä»·ã€‚
3.  ç‚¹å‡»å†™å…¥æŒ‰é’®ã€‚åœ¨å…ƒæ©ç å¼¹å‡ºçª—å£ä¸­ç­¾ç½²äº‹åŠ¡ï¼Œå¹¶ç­‰å¾…äº‹åŠ¡å®Œæˆã€‚

æ­å–œ<g-emoji class="g-emoji" alias="tada" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f389.png">ğŸ‰</g-emoji> <g-emoji class="g-emoji" alias="tada" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f389.png">ğŸ‰</g-emoji> <g-emoji class="g-emoji" alias="tada" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f389.png">ğŸ‰</g-emoji>ã€‚ä½ å·²æˆåŠŸå°†ä½ çš„ NFT åˆŠç™»åœ¨å¸‚åœºä¸Šï¼Œç°åœ¨å¯ä»¥äº¤æ˜“äº†ã€‚

# ç»“è®º

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•åˆ›å»ºä¸€ä¸ªå¯ç”¨äºä¹°å– NFT çš„å¸‚åœºæ™ºèƒ½åˆçº¦ã€‚æˆ‘ä»¬ä¸ºå¸‚åœºç¼–å†™äº†åº•å±‚æ™ºèƒ½åˆåŒï¼Œå¯¹å…¶è¿›è¡Œäº†å•å…ƒæµ‹è¯•ä»¥ç¡®ä¿å…¶æŒ‰é¢„æœŸå·¥ä½œï¼Œå°†å…¶éƒ¨ç½²åˆ°å­Ÿä¹°æµ‹è¯•ç½‘å¹¶éªŒè¯äº†æºä»£ç ï¼Œå› æ­¤å®ƒåœ¨ Polygonscan ä¸Šæ˜¯å¯è§çš„ã€‚æˆ‘ä»¬è¿˜å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨ HardHat çš„`console.log()`åŠŸèƒ½å°†æ™ºèƒ½åˆçº¦ä¸­çš„å€¼æ‰“å°åˆ°æ§åˆ¶å°ã€‚æˆ‘ä»¬ä»‹ç»äº†ä¸€ä¸ªæ™ºèƒ½åˆçº¦å¦‚ä½•åœ¨åŒä¸€åŒºå—é“¾ä¸Šè°ƒç”¨å¦ä¸€ä¸ªæ™ºèƒ½åˆçº¦ï¼Œä»¥åŠæˆ‘ä»¬å¯ä»¥å…è®¸å…¶ä»–å¸æˆ·/æ™ºèƒ½åˆçº¦ä»£è¡¨æˆ‘ä»¬ä½¿ç”¨ tokenã€‚

# åç»­æ­¥éª¤

å­¦ä¹ ä¹‹æ—…æ°¸ä¸åœæ¯ï¼æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨åƒ Unity3D è¿™æ ·çš„ 3D æ¸¸æˆå¼•æ“æ¥åˆ›å»ºä¸€ä¸ªäº¤äº’å¼è‰ºæœ¯ç”»å»Šï¼Œç©å®¶å¯ä»¥åœ¨è¿™é‡Œè‡ªç”±ç§»åŠ¨ï¼Œå¹¶æŸ¥çœ‹æˆ‘ä»¬çš„å¸‚åœºæ™ºèƒ½åˆåŒä¸­åˆ—å‡ºçš„å„ç§ NFT è‰ºæœ¯å“ã€‚

# å…³äºä½œè€…

å—¨ï¼Œæˆ‘çš„åå­—æ˜¯ Bhaskar Duttaï¼Œæˆ‘æ˜¯ä¸€ååŒºå—é“¾å¼€å‘è€…ï¼Œç ”ç©¶å‘˜å’Œè‡ªç”±èŒä¸šè€…ã€‚æˆ‘æ€»æ˜¯æœŸå¾…ç€å­¦ä¹ æ–°çš„ä¸œè¥¿å’Œè®¨è®ºå…³äºæƒ…æ™¯å–œå‰§ã€‚æƒ³æ›´å¥½çš„äº†è§£æˆ‘ï¼Œå¯ä»¥å»çœ‹çœ‹æˆ‘çš„ [Github](https://github.com/BhaskarDutta2209) ã€‚

# å‚è€ƒ

ä»¥ä¸‹èµ„æºå¯¹æˆ‘å¾ˆæœ‰å¸®åŠ©:

1.  [å®‰å…¨å¸½å®˜æ–¹æ–‡æ¡£](https://hardhat.org/)
2.  [å¤šè¾¹å½¢å®˜æ–¹æ–‡æ¡£](https://docs.polygon.technology/)