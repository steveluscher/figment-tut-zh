# åŒºå—é“¾è¯·æ±‚

> åŸæ–‡:[https://github . com/fig ment-networks/learn-tutorials/blob/master/Solana/Solana-wallet/wallet-tutorial-step-3 . MD](https://github.com/figment-networks/learn-tutorials/blob/master/solana/solana-wallet/wallet-tutorial-step-3.md)

åŠ å¯†é’±åŒ…æœ‰ä¸€ä¸ªä¸»è¦åŠŸèƒ½â€”â€”å­˜å‚¨ä½ çš„ç§äººå¯†é’¥ã€‚é€šè¿‡å­˜å‚¨æ‚¨çš„ç§é’¥ï¼Œå®ƒä»¬å…è®¸æ‚¨ç®¡ç†-è½¬ç§»ï¼Œæ¥æ”¶ï¼Œç»„ç»‡-æ‚¨çš„æ•°å­—èµ„äº§ã€‚è¯¥åŠŸèƒ½çš„ä¸€éƒ¨åˆ†è¦æ±‚é’±åŒ…æ£€ç´¢å­˜å‚¨åœ¨é“¾ä¸Šçš„æŸäº›æ•°æ®ï¼Œä»¥æ˜¾ç¤ºåœ¨æ‚¨çš„ç”¨æˆ·ä»ªè¡¨æ¿ä¸Šã€‚

ä½™é¢ä»£è¡¨è´¦æˆ·æŒæœ‰çš„ä¸€å®šæ•°é‡çš„åŠ å¯†è´§å¸æˆ–ä»£å¸ã€‚å¦‚æœæ‚¨å°†åŒºå—é“¾è§†ä¸ºä¿å­˜æ‰€æœ‰æƒè®°å½•çš„æ•°æ®åº“ï¼Œå°†å…¬é’¥è§†ä¸ºæ‰€æœ‰è€… idï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥å°†ä½™é¢è§†ä¸ºæ•°æ®åº“ä¸­çš„ä¸€ä¸ªæ•´æ•°åˆ—ï¼Œç”¨äºè·Ÿè¸ªæ¯ä¸ªæ‰€æœ‰è€…æŒæœ‰å¤šå°‘ç‰¹å®šä»¤ç‰Œã€‚

æˆ‘ä»¬å°†è¿æ¥åˆ° Solana çš„ä¸€ä¸ªç½‘ç»œï¼Œå¹¶è·å–æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„å¸æˆ·çš„ä½™é¢ã€‚ç¨ååœ¨[æ­¥éª¤ 4](https://learn.figment.io/tutorials/solana-wallet-step-4) ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ airdrop åŠŸèƒ½å‘å¸æˆ·æ³¨å…¥æµ‹è¯•ä»¤ç‰Œã€‚

## ç½‘ç»œ

å•ä¸ªåè®®çš„å„ç§ç½‘ç»œçš„æ¦‚å¿µç±»ä¼¼äºä¸€ä¸ªåº”ç”¨ç¨‹åºçš„ä¸åŒç¯å¢ƒçš„æ¦‚å¿µ(ä¾‹å¦‚ï¼Œå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç­‰)ã€‚é€šå¸¸ï¼ŒåŒºå—é“¾åè®®æœ‰ä¸€ä¸ªä¸»ç½‘ç»œæˆ– mainnetï¼ŒæŒ‡çš„æ˜¯å…·æœ‰å®é™…ç»æµä»·å€¼å’Œå®˜æ–¹äº¤æ˜“çš„ç”Ÿäº§åŒºå—é“¾ï¼Œä»¥åŠè‡³å°‘ä¸€ä¸ªå®éªŒç½‘ç»œï¼ŒæŒ‡çš„æ˜¯åœ¨ mainnet ä¸Šçº¿ä¹‹å‰ç”¨äºæµ‹è¯•åŠŸèƒ½çš„ç›¸åŒåŒºå—é“¾ã€‚

[![Figure 4: It's always important to test on devnet before deploying on mainnet](../Images/4721189f409685b68567b0de02afa229.png)T2ã€‘](https://raw.githubusercontent.com/figment-networks/learn-tutorials/master/solana/solana-wallet/assets/consultant.jpeg)

{% label %}å›¾ 4:åœ¨ mainnet ä¸Šéƒ¨ç½²ä¹‹å‰ï¼Œåœ¨ devnet ä¸Šè¿›è¡Œæµ‹è¯•æ€»æ˜¯å¾ˆé‡è¦çš„

Solana æœ‰ä¸€ä¸ªåä¸º mainnet çš„ç”Ÿäº§ç½‘ç»œå’Œä¸¤ä¸ªåä¸º testnet å’Œ devnet çš„å®éªŒç½‘ç»œã€‚Solana çš„ devnet æ˜¯ä¸ºå¼€å‘äººå‘˜å’Œç”¨æˆ·è®¾è®¡çš„ï¼Œåœ¨ mainnet ä¸Šå‘å¸ƒä¹‹å‰ï¼Œä»–ä»¬å¯ä»¥å°è¯•å„ç§åŠŸèƒ½å¹¶è°ƒè¯• dAppsï¼Œä»è€Œå¸¦æ¥çœŸæ­£çš„ç»æµæ•ˆç›Šã€‚testnet æ˜¯ Solana æµ‹è¯•æ½œåœ¨åè®®æ›´æ–°çš„åœ°æ–¹ã€‚

ä½ ä¼šæ³¨æ„åˆ°é’±åŒ…çš„å³ä¸Šè§’æœ‰ä¸€ä¸ªä¸‹æ‹‰èœå•ï¼Œå…è®¸ç”¨æˆ·é€‰æ‹©ä»–ä»¬æƒ³è¦è¿æ¥çš„ç½‘ç»œã€‚è¿™å…è®¸é’±åŒ…ç®¡ç†ç‰¹å®šäºè¿æ¥ç½‘ç»œçš„èµ„äº§ã€‚æˆ‘ä»¬çš„é»˜è®¤ç½‘ç»œæ˜¯ devnetï¼Œå› ä¸ºæˆ‘ä»¬å°†ä½¿ç”¨å®ƒåœ¨[æ­¥éª¤ 4](https://learn.figment.io/tutorials/solana-wallet-step-4) ä¸­æ¥æ”¶æµ‹è¯•ä»¤ç‰Œï¼Œç„¶ååœ¨[æ­¥éª¤ 5](https://learn.figment.io/tutorials/solana-wallet-step-5) ä¸­ä¼ è¾“å®ƒä»¬ï¼Œä½†æ˜¯æˆ‘ä»¬å°†æ„å»ºçš„åŠŸèƒ½å°†é€‚ç”¨äºä»»ä½• Solana ç½‘ç»œã€‚

# å®æ–½ <g-emoji class="g-emoji" alias="jigsaw" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f9e9.png">ğŸ§©</g-emoji>

åœ¨[æ­¥éª¤ 2](https://learn.figment.io/tutorials/solana-wallet-step-2) ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†é’±åŒ…å¦‚ä½•æ›´åƒä¸€ä¸ªé’¥åŒ™é“¾ï¼Œå®ƒä¿å­˜ç€ä»£è¡¨å¸æˆ·åœ°å€çš„å¯†é’¥å¯¹å’Œè®¿é—®å®ƒçš„å¯†é’¥ã€‚æˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªåŠŸèƒ½ï¼Œå…è®¸æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„å¸æˆ·å’Œç›¸åº”çš„çŸ­è¯­ï¼Œå°±åƒè®¿é—®å¸æˆ·çš„å¯†ç ä¸€æ ·ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦è¿æ¥ç´¢æ‹‰çº³åŒºå—é“¾ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è·å–å¸æˆ·çš„ä½™é¢ï¼Œæ­¤æ—¶åº”è¯¥ä¸ºé›¶ï¼Œå› ä¸ºæˆ‘ä»¬åˆšåˆšåˆ›å»ºäº†å®ƒã€‚

## è¿æ¥

ä¸ä»»ä½•åŒºå—é“¾äº¤äº’çš„ç¬¬ä¸€æ­¥æ˜¯å®ä¾‹åŒ–ä¸€ä¸ªè¿æ¥ã€‚æ–¹ä¾¿çš„æ˜¯ï¼Œweb3.js ä¸­æœ‰ä¸€ä¸ª`Connection`ç±»å°±æ˜¯ä¸ºäº†åšè¿™ä»¶äº‹è€Œè®¾è®¡çš„ã€‚é€šè¿‡æŸ¥çœ‹æ–‡æ¡£ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°`Connection`æ„é€ å‡½æ•°éœ€è¦ä¸¤ä¸ªå‚æ•°:`endpoint: string`å’Œ`commitmentOrConfig?: Commitment | ConnectionConfig`ã€‚

å¯¹`endpoint`çš„æè¿°æåˆ°å®ƒæ˜¯ä¸€ä¸ªâ€œæŒ‡å‘ fullnode JSON RPC ç«¯ç‚¹çš„ URLâ€ã€‚ç”±äºæˆ‘ä»¬æ²¡æœ‰ç”¨äºè¿æ¥çš„ URLï¼Œæˆ‘ä»¬éœ€è¦ä» Solana ä¸­æ‰¾åˆ°ä¸€ä¸ªï¼Œæˆ–è€…å¯»æ‰¾ä¸€ä¸ªå°†è¿”å› URL çš„å‡½æ•°ã€‚é€šè¿‡åœ¨ web3.js æ–‡æ¡£ä¸­æœç´¢â€œURLâ€ï¼Œæˆ‘ä»¬çœ‹åˆ°æœ‰ä¸€ä¸ªåä¸º`clusterApiUrl`çš„å‡½æ•°è¿”å›â€œæŒ‡å®šé›†ç¾¤çš„ RPC API URLâ€ã€‚æ­¤å¤–ï¼Œå¦‚æœæˆ‘ä»¬å›é¡¾ä¸€ä¸‹`Cluster`ç±»å‹ï¼Œæˆ‘ä»¬ä¼šå‘ç°å®ƒæŒ‡çš„æ˜¯æˆ‘ä»¬æƒ³è¦è¿æ¥çš„ç½‘ç»œã€‚

è‡³äº`commitmentOrConfig`ï¼Œçœ‹èµ·æ¥å¯¹`Commitment`ç±»å‹çš„å®šä¹‰å°†å…¶æè¿°ä¸ºâ€œæŸ¥è¯¢çŠ¶æ€æ—¶æ‰€éœ€çš„æ‰¿è¯ºçº§åˆ«â€ï¼Œåœ¨è¿™ä¸€ç‚¹ä¸Šå¯¹æˆ‘ä»¬æ¥è¯´è¿™æ˜¯ä¸€ä¸ªæ²¡æœ‰æ„ä¹‰çš„å®šä¹‰ã€‚ç„¶è€Œï¼Œçœ‹èµ·æ¥`Commitment`å¯èƒ½æ˜¯å‡ ä¸ªå­—ç¬¦ä¸²ä¸­çš„ä¸€ä¸ªï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥é€‰æ‹©ä¸€ä¸ªå¹¶æµ‹è¯•å…¶åŠŸèƒ½ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©â€œç¡®è®¤â€ä½œä¸ºåˆç†çš„çŒœæµ‹ï¼Œå¹¶ç»§ç»­å‰è¿›ã€‚

{% sidenote title="Box 3.1:å…³äºæŠ€æœ¯å¤æ‚æ€§çš„è¯´æ˜" %}åœ¨ä»–å…³äºè½¯ä»¶å¼€å‘çš„å¼€åˆ›æ€§ç³»åˆ—ä¸­ï¼ŒMichael Hartl å’Œ[Learn full](https://www.learnenough.com/)å›¢é˜Ÿå¼•å…¥äº†*æŠ€æœ¯å¤æ‚æ€§çš„æ¦‚å¿µ*ä½œä¸ºæŠ€æœ¯å¼€å‘è¿‡ç¨‹çš„å…³é”®å±æ€§ã€‚ä»–ä»¬å°†å…¶å®šä¹‰ä¸ºâ€œè½¯ç¡¬æŠ€èƒ½çš„ç»“åˆï¼Œè®©ä½ çœ‹èµ·æ¥å¥½åƒå¯ä»¥ç¥å¥‡åœ°è§£å†³ä»»ä½•æŠ€æœ¯é—®é¢˜ã€‚â€æŠŠäº‹æƒ…ææ¸…æ¥šï¼Œè¶³æ™ºå¤šè°‹ï¼Œè‡³å°‘æ˜¯æˆåŠŸçš„ä¸€åŠï¼Œæœ‰æ—¶ç”šè‡³æ˜¯æˆ˜äº‰çš„å…¨éƒ¨ã€‚å¦‚æœ‰ç–‘é—®ï¼Œè¯·å‚è€ƒ [xkcd æµç¨‹å›¾](https://m.xkcd.com/627/)ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹ç”¨`utils/index.ts`ä¸­çš„è¿æ¥å®ä¾‹å®ç°`refreshBalance`åŠŸèƒ½:

```
const connection = new Connection(clusterApiUrl(network), "confirmed");
console.log(connection)

// console:
> ConnectionÂ {_commitment: 'confirmed', _confirmTransactionInitialTimeout: undefined, _rpcEndpoint: 'https://api.devnet.solana.com', _rpcWsEndpoint: 'wss://api.devnet.solana.com/', _rpcClient: ClientBrowser,Â â€¦}
```

## è·å–æ•°æ®

ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªè¿æ¥ï¼Œæˆ‘ä»¬éœ€è¦è·å–æˆ‘ä»¬è´¦æˆ·çš„ä½™é¢ã€‚æˆ‘ä»¬å¯èƒ½æ¨æµ‹åº”è¯¥æœ‰ä¸€ä¸ª`getBalance`å‡½æ•°ï¼Œå®ƒå°†å¸æˆ·çš„å…¬å…±åœ°å€ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›å¸æˆ·çš„ä½™é¢ã€‚åœ¨ web3.js æ–‡æ¡£ä¸­æœç´¢å…³é”®å­—â€œbalance â€,æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä¸ä»…æœ‰ä¸€ä¸ª`getBalance`æ–¹æ³•ï¼Œè€Œä¸”æ˜¯ä¸€ä¸ª`Connection`ç±»æ–¹æ³•ã€‚

å›é¡¾ä¸€ä¸‹`Connection`ä¸Šçš„`getBalance`æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒéœ€è¦è´¦æˆ·çš„å…¬é’¥ä½œä¸ºå‚æ•°ã€‚

```
const publicKey = account.publicKey;
const balance = await connection.getBalance(publicKey);
console.log(balance);

// console:
> 0;
```

æœ‰å‡ ç§æ–¹æ³•æ¥æ„å»ºè¿™éƒ¨åˆ†åŠŸèƒ½ã€‚æˆ‘ä»¬é€‰æ‹©å°†`publicKey`å˜é‡èµ‹ç»™è´¦æˆ·çš„å…¬é’¥ï¼Œç„¶åå°†å®ƒä¼ é€’ç»™`getBalance`æ¥æŸ¥è¯¢ç½‘ç»œä½™é¢ã€‚

ä»æ–‡æ¡£ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“`getBalance`è¿”å›ä¸€ä¸ªæ‰¿è¯ºï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨`await`å¹¶å°†å®ƒçš„è¿”å›å€¼èµ‹ç»™`balance`å˜é‡ã€‚é€šè¿‡ç™»å½•`balance`ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„è´¦æˆ·å¦‚é¢„æœŸçš„é›¶ä½™é¢ã€‚

ä½†è¿™æœ‰ç‚¹è™å¤´è›‡å°¾ã€‚æˆ‘ä»¬çŸ¥é“è¿™æ˜¯ä¸€ä¸ªæ–°è´¦æˆ·ï¼Œåº”è¯¥æ²¡æœ‰ä½™é¢ã€‚å‰ç«¯æ²¡æœ‰ä»»ä½•å˜åŒ–ï¼Œå› ä¸ºé»˜è®¤å€¼ä¸ºé›¶ã€‚æˆ‘ä»¬éœ€è¦ä¸ºè´¦æˆ·æ³¨å…¥èµ„é‡‘ä»¥æŸ¥çœ‹ä½™é¢å˜åŒ–ï¼Œæˆ‘ä»¬å°†åœ¨[æ­¥éª¤ 4](https://learn.figment.io/tutorials/solana-wallet-step-4) ä¸­è¿™æ ·åšã€‚

##### *æ¸…å• 3.2:è·å–ä½™é¢çš„ä»£ç *

```
const refreshBalance = async (network: Cluster, account: Keypair | null) => {
  if (!account) return;

  try {
    const connection = new Connection(clusterApiUrl(network), "confirmed");
    const publicKey = account.publicKey;
    const balance = await connection.getBalance(publicKey);
    return balance;
  } catch (error) {
    console.log(error);
    return 0;
  }
};
```

# æŒ‘æˆ˜<g-emoji class="g-emoji" alias="weight_lifting" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f3cb.png">ğŸ‹ï¸</g-emoji>

å¦‚æœæ‚¨ä»`/wallet`é¡µé¢æ‰“å¼€æµè§ˆå™¨çš„æ§åˆ¶å°ï¼Œæ‚¨ä¼šæ³¨æ„åˆ°ä¸€æ¡æ¶ˆæ¯ï¼Œä¸Šé¢å†™ç€:â€œå¹³è¡¡åŠŸèƒ½å°šæœªå®ç°ï¼â€ã€‚åœ¨ç¼–è¾‘å™¨ä¸­å¯¼èˆªåˆ°`utils/index.ts`,æŒ‰ç…§æ³¨é‡Šä¸­åŒ…å«çš„æ­¥éª¤å®Œæˆ`refreshBalance`å‡½æ•°çš„ç¼–å†™ã€‚æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªæè¿°ï¼Œä»¥åŠä¸€ä¸ªé“¾æ¥ï¼Œé“¾æ¥åˆ°æ‚¨ä¸ºäº†å®ç°æ¯ä¸€è¡Œè€Œéœ€è¦æŸ¥çœ‹çš„æ–‡æ¡£ã€‚ç›¸å…³ä»£ç å—ä¹ŸåŒ…å«åœ¨ä¸‹é¢çš„[æ¸…å• 3.1](#listing-31-instructions-for-fetching-an-accounts-balance) ä¸­ã€‚

##### *æ¸…å• 3.1:è·å–è´¦æˆ·ä½™é¢çš„æŒ‡ä»¤*

```
// *Step 3*: implement a function that gets an account's balance
const refreshBalance = async (network: Cluster, account: Keypair | null) => {
  // This line ensures the function returns before running if no account has been set
  if (!account) return 0;

  try {
    // (a) review the import guidance on line 1
    // (b) instantiate a connection using clusterApiUrl with the active network passed in as an argument
    // Documentation References:
    //   https://solana-labs.github.io/solana-web3.js/classes/Connection.html
    //   https://solana-labs.github.io/solana-web3.js/modules.html#clusterApiUrl
    console.log("Balance functionality not implemented yet!");
    const connection = "";

    // (c) get the key using one of the accessors on the account passed in as an argument
    // Documentation Reference: https://solana-labs.github.io/solana-web3.js/classes/Keypair.html
    const publicKey = "";

    // (d) get the account's balance using the connection instance
    // Documentation Reference: https://solana-labs.github.io/solana-web3.js/classes/Connection.html
    const balance = 0;

    return balance;
    // (e) You can now delete the console.log statement since the function is implemented!
  } catch (error) {
    console.log(error);
    return 0;
  }
};
```