# å®æ–½ğŸ§©

> åŸæ–‡:[https://github . com/fig ment-networks/learn-tutorials/blob/master/mirror/05-display-entries . MD](https://github.com/figment-networks/learn-tutorials/blob/master/mirror/05-display-entries.md)

å¦‚æœæ‚¨å·²ç»åœ¨ Web 2 ä¸Šå¼€å‘äº†å…¨æ ˆåº”ç”¨ç¨‹åºï¼Œæ‚¨å¯èƒ½å¯¹æŸ¥è¯¢æ„å»ºå™¨çš„æ¦‚å¿µå¾ˆç†Ÿæ‚‰ã€‚è¿™äº›åº“é€šè¿‡ä¸ºæ•°æ®åº“äº¤äº’åˆ›å»ºä¸€ä¸ªè¯­è¨€åŸç”Ÿ API æ¥ç®€åŒ–ä¸æ•°æ®åº“çš„äº¤äº’ï¼Œè¯¥ API æŠ½è±¡äº†ç¼–å†™ç›´æ¥ SQL çš„å¤æ‚æ€§ã€‚

æˆ‘ä»¬å°†åœ¨ Web 3 ä¸­ä½¿ç”¨ç±»ä¼¼çš„å·¥å…·ã€‚è¿™ä¸€æ­¥å°†éœ€è¦æˆ‘ä»¬åˆ©ç”¨[ArDB](https://www.npmjs.com/package/ardb)â€”â€”ä¸€ç§ä½¿ç”¨ Typescript ä¸ Arweave äº¤äº’çš„æ–¹å¼ï¼Œå› æ­¤æˆ‘ä»¬ä¸éœ€è¦ç›´æ¥ç¼–å†™ GraphQLã€‚

æˆ‘ä»¬å°†ä»æ‰“å¼€æ¡ç›®æŸ¥è¯¢ç«¯ç‚¹æ–‡ä»¶`pages/api/arweave/search/[[query]].ts`å¼€å§‹ã€‚åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯åŠ¨äº†ä¸€ä¸ªæ¥æ”¶æŸ¥è¯¢å¹¶è¿”å›æ¡ç›®åˆ—è¡¨çš„å‡½æ•°ã€‚ç›®æ ‡æ˜¯è®©å®¢æˆ·ç«¯æ¥æ”¶åˆ—è¡¨å¹¶æ˜¾ç¤ºå®ƒï¼Œè¿™æ ·ç”¨æˆ·å°±å¯ä»¥é€‰æ‹©ä¸€ä¸ªæ¡ç›®æ¥é˜…è¯»ã€‚

è¿™ä¸ªç«¯ç‚¹åº”è¯¥è¶³å¤Ÿçµæ´»ï¼Œèƒ½å¤Ÿå¤„ç†å¯¹åº”ç”¨ç¨‹åºä¸Šå‘å¸ƒçš„æœ€æ–°æ¡ç›®ä»¥åŠç‰¹å®šç”¨æˆ·å‘å¸ƒçš„æœ€æ–°æ¡ç›®çš„è¯·æ±‚ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬åº”è¯¥å®ä¾‹åŒ–ä¸€ä¸ª ArDB å®ä¾‹ï¼Œè¿™å¯ä»¥é€šè¿‡ç¡®è®¤æˆ‘ä»¬å·²ç»å®‰è£…äº†ç›¸å…³çš„åŒ…å¹¶å°† ArDB å¯¼å…¥åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­æ¥å®Œæˆã€‚æˆ‘ä»¬è¿˜åº”è¯¥ç”¨åº”ç”¨ç¨‹åºååˆ›å»ºä¸€ä¸ª`tags`å˜é‡ã€‚

```
const ardb = new ArDB(arweave);
const tags = [{ name: "App-Name", values: [process.env.APP_NAME as string] }];
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åº”è¯¥ä»`query`å‚æ•°ä¸­æ£€ç´¢ä½œè€…çš„åœ°å€(å¦‚æœæœ‰çš„è¯),å¹¶åœ¨æ ‡ç­¾åˆ—è¡¨ä¸­åˆ›å»ºå¦ä¸€ä¸ªæ ‡ç­¾:

```
const searchAddress = query && query[0];

if (searchAddress) {
  tags.push({ name: "Address", values: [searchAddress] });
}
```

æœ‰äº†æˆ‘ä»¬éœ€è¦çš„ä¸€åˆ‡ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨`ardb`å‘å‡ºä¸€ä¸ªæœç´¢æŸ¥è¯¢ï¼ŒæŸ¥æ‰¾ä¸æˆ‘ä»¬çš„`tags`åŒ¹é…çš„äº¤æ˜“ã€‚ä¸å…¶ä»–æŸ¥è¯¢æ„å»ºå™¨ç±»ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥é“¾æ¥æ–¹æ³•æ¥å¢åŠ æŸ¥è¯¢çš„ç‰¹å¼‚æ€§ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°æœ€è¿‘çš„ 10 ä¸ªæ¡ç›®ã€‚

```
const txs = await ardb.search("transactions").tags(tags).limit(10).find();
```

ç°åœ¨ä¸€åˆ‡å°±ç»ªã€‚å¦‚æœæ‚¨åˆ·æ–° dAppï¼Œæ‚¨å°†çœ‹åˆ°æ‚¨åœ¨å‰é¢çš„æ­¥éª¤ä¸­åˆ›å»ºçš„æ¡ç›®ã€‚ç¥å¥‡ï¼

[![And all the entries simply... appear!](../Images/e23403b0734b19e70d8227869ee8bd93.png)T2ã€‘](https://raw.githubusercontent.com/figment-networks/learn-tutorials/master/mirror/assets/magic.jpeg)

{% label %}å’Œæ‰€æœ‰æ¡ç›®...å‡ºç°ï¼

æ­¤æ—¶ï¼Œæ‚¨å¯èƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ¡ç›®æ¥æµ‹è¯•åŠŸèƒ½ã€‚ä½ ç»å¯¹åº”è¯¥è¿™ä¹ˆåšï¼ä½†æ˜¯ï¼Œå½“æ‚¨ç‚¹å‡»åˆšåˆšåˆ›å»ºçš„æ¡ç›®æ—¶ï¼Œå¦‚æœæ‚¨æ²¡æœ‰è·å¾—æ¡ç›®ï¼Œè€Œæ˜¯å¾—åˆ°ä¸€æ¡æ¶ˆæ¯ï¼Œå‘Šè¯‰æ‚¨å®ƒå°šæœªå¾—åˆ°ç¡®è®¤ï¼Œè¯·ä¸è¦æƒŠæ…Œã€‚

å›æƒ³ä¸€ä¸‹**æ–¹æ¡† 4.1** ä¸­çš„å†…å®¹ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿéœ€è¦å‡ åˆ†é’Ÿæ¥è¾¾æˆå…±è¯†å¹¶ç¡®è®¤äº¤æ˜“ã€‚ä¸æ–­è¿›æ­¥ï¼Œåœ¨ä½ å®Œæˆç¬¬ 6 æ­¥ä¹‹å‰ï¼Œä½ çš„æ¡ç›®å°±å·²ç»å‡†å¤‡å¥½äº†ã€‚

æ‚¨è¿˜ä¼šæ³¨æ„åˆ°ï¼Œå¦‚æœæ‚¨å•å‡»ä¸€ä¸ªæ¡ç›®ï¼Œåœ¨ NFT æ¡†ä¸­ä¼šå‡ºç°ä¸€æ¡å¸¦æœ‰é”™è¯¯æ¶ˆæ¯çš„è­¦å‘Šã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬ç›®å‰æœ‰ä¸€ä¸ªé›¶åœ°å€ä½œä¸ºé»˜è®¤æ™ºèƒ½åˆçº¦åœ°å€ã€‚æˆ‘ä»¬å°†åœ¨ç¬¬ 6 æ­¥ä¸­è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

##### *æ¸…å• 5.1:è·å–æ¡ç›®åˆ—è¡¨çš„ä»£ç *

```
try {
  const {query} = _req.query;

  const ardb = new ArDB(arweave);

  const searchAddress = query && query[0];

  const tags = [{name: 'App-Name', values: [process.env.APP_NAME as string]}];
  if (searchAddress) {
    tags.push({name: 'Address', values: [searchAddress]});
  }

  const txs = await ardb.search('transactions').tags(tags).limit(10).find();

  const promises = txs.map((tx: any) => getData(tx._id));
  const data = await Promise.all(promises);

  res.status(200).json(data);
}
```

# æŒ‘æˆ˜<g-emoji class="g-emoji" alias="weight_lifting" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f3cb.png">ğŸ‹ï¸</g-emoji>

åœ¨ä»£ç ç¼–è¾‘å™¨ä¸­å¯¼èˆªåˆ°`api/arweave/search/[[query]].ts`,æŒ‰ç…§æ³¨é‡Šä¸­åŒ…å«çš„æ­¥éª¤å®ŒæˆæŸ¥è¯¢ç«¯ç‚¹çš„ç¼–å†™ã€‚æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªæè¿°ï¼Œä»¥åŠä¸€ä¸ªé“¾æ¥ï¼Œé“¾æ¥åˆ°æ‚¨ä¸ºäº†å®ç°æ¯ä¸€è¡Œè€Œéœ€è¦æŸ¥çœ‹çš„æ–‡æ¡£ã€‚ç›¸å…³çš„ä»£ç å—ä¹ŸåŒ…å«åœ¨ä¸‹é¢çš„æ¸…å• 5.2 ä¸­ã€‚

##### *æ¸…å• 5.2:è·å–æ¡ç›®åˆ—è¡¨çš„æŒ‡ä»¤*

```
try {
  const {query} = _req.query;

  // Initialize ArDB
  // More information about ArDB can be found here: https://www.npmjs.com/package/ardb

  // Retrieve searchAddress

  // Build tags

  // Search for transaction withs App-Name and Address (optional) tags
  // More information can be found here: https://www.npmjs.com/package/ardb

  const promises = txs.map((tx: any) => getData(tx._id));
  const data = await Promise.all(promises);

  res.status(200).json(data);
}
```

ä»£ç å®Œæˆåï¼Œæ‚¨å°†èƒ½å¤Ÿåœ¨ä»ªè¡¨æ¿ä¸Šä»¥åŠæ‚¨çš„ç”¨æˆ·èµ„æ–™ä¸‹çœ‹åˆ°å¸–å­åˆ—è¡¨:

[![Screenshot displaying a list of entries](../Images/d57e0e460d52fd4809fa393fb9acd206.png)T2ã€‘](https://raw.githubusercontent.com/figment-networks/learn-tutorials/master/mirror/assets/entries.jpg)